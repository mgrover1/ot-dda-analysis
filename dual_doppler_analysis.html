
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dual Doppler Analysis &#8212; Overshooting Top Dual Doppler Analysis</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plot Dual Doppler Output" href="plot_dual_doppler_output.html" />
    <link rel="prev" title="Preprocess Dual Doppler Data" href="dual_doppler_preprocess.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/relampago_logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Overshooting Top Dual Doppler Analysis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="introduction.html">
                    Overview
                </a>
            </li>
        </ul>
        <p class="caption">
 <span class="caption-text">
  SGP Summer Experiment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sgp-summer-experiment/visualize-updrafts-sgp.html">
   Visualize Dual-Doppler Output from the Southern Great Plains Site
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sgp-summer-experiment/plot-ots-in-domain.html">
   Plot OTs from the SGP Summer Experiment
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Overshooting Tops
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="process_ot_data.html">
   Overshooting Top Area Quantification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Track_OTs.html">
   Track OTs
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Dual Doppler Analysis
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dual_doppler_preprocess.html">
   Preprocess Dual Doppler Data
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Dual Doppler Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot_dual_doppler_output.html">
   Plot Dual Doppler Output
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Uncertainty
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ot_ua_uncertainty.html">
   Overshooting Top Area - Updraft Area Uncertainty
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/dual_doppler_analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/dual_doppler_analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iop4-10-november-case">
   IOP4 10 November Case
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#november-case">
   12 November Case
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#december-case">
   4 December Case
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Dual Doppler Analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iop4-10-november-case">
   IOP4 10 November Case
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#november-case">
   12 November Case
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#december-case">
   4 December Case
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="dual-doppler-analysis">
<h1>Dual Doppler Analysis<a class="headerlink" href="#dual-doppler-analysis" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyart</span>
<span class="kn">import</span> <span class="nn">pydda</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">glob</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>## You are using the Python ARM Radar Toolkit (Py-ART), an open source
## library for working with weather radar data. Py-ART is partly
## supported by the U.S. Department of Energy as part of the Atmospheric
## Radiation Measurement (ARM) Climate Research Facility, an Office of
## Science user facility.
##
## If you use this software to prepare a publication, please cite:
##
##     JJ Helmus and SM Collis, JORS 2016, doi: 10.5334/jors.119
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in the CSU sounding for this case</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;../../Downloads/CSU_griddedsounding.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">launch_time</span><span class="o">=</span><span class="s1">&#39;2018-11-10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">launch_time</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;2018-11-10T22:09:00.000000000&#39;, &#39;2018-11-10T21:04:00.000000000&#39;,
       &#39;2018-11-10T20:01:00.000000000&#39;, &#39;2018-11-10T20:00:00.000000000&#39;,
       &#39;2018-11-10T18:06:00.000000000&#39;, &#39;2018-11-10T17:04:00.000000000&#39;,
       &#39;2018-11-10T16:02:00.000000000&#39;, &#39;2018-11-10T15:00:00.000000000&#39;],
      dtype=&#39;datetime64[ns]&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sounding_ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">launch_time</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">launch_time</span><span class="o">=</span><span class="s1">&#39;2018-11-10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">launch_time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uwnd</span> <span class="o">=</span> <span class="n">sounding_ds</span><span class="o">.</span><span class="n">Ucmp</span><span class="o">.</span><span class="n">values</span>
<span class="n">vwnd</span> <span class="o">=</span> <span class="n">sounding_ds</span><span class="o">.</span><span class="n">Vcmp</span><span class="o">.</span><span class="n">values</span>
<span class="n">alt</span> <span class="o">=</span> <span class="n">sounding_ds</span><span class="o">.</span><span class="n">Alt</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">HorizontalWindProfile</span><span class="o">.</span><span class="n">from_u_and_v</span><span class="p">(</span><span class="n">alt</span><span class="p">,</span> <span class="n">uwnd</span><span class="p">,</span> <span class="n">vwnd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_radars</span><span class="p">(</span><span class="n">radar</span><span class="p">):</span>
    <span class="n">display</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">RadarDisplay</span><span class="p">(</span><span class="n">radar</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>

    <span class="n">nyq</span> <span class="o">=</span> <span class="n">radar</span><span class="o">.</span><span class="n">instrument_parameters</span><span class="p">[</span><span class="s1">&#39;nyquist_velocity&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Reflectivity</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;DBZHC_F&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">32</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">64.</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">plot_range_rings</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
    <span class="n">display</span><span class="o">.</span><span class="n">plot_cross_hair</span><span class="p">(</span><span class="mf">5.</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">set_limits</span><span class="p">((</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Radial Velocity</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;VEL_F&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;pyart_balance&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">plot_range_rings</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
    <span class="n">display</span><span class="o">.</span><span class="n">set_limits</span><span class="p">((</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1">#display.set_limits((-300, 300), (-300, 300), ax=ax)</span>

    <span class="c1"># Corrected Reflectivity - Karen</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;ZM&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">32</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">64.</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">plot_range_rings</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
    <span class="n">display</span><span class="o">.</span><span class="n">set_limits</span><span class="p">((</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="c1"># Corrected Radial Velocity - Karen</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;VM&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">nyq</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">nyq</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;pyart_balance&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="o">.</span><span class="n">plot_range_rings</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">])</span>
    <span class="n">display</span><span class="o">.</span><span class="n">set_limits</span><span class="p">((</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
<span class="c1">#plt.savefig(&#39;radar_explore/DOW6_comparison.png&#39;, dpi=200)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grid_radars</span><span class="p">(</span><span class="n">dow7_file</span><span class="p">,</span> <span class="n">dow6_file</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.03</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes list of radar files and creates a grid</span>
<span class="sd">    </span>
<span class="sd">    Input</span>
<span class="sd">    ----------</span>
<span class="sd">    list_files: list of radar files</span>
<span class="sd">    </span>
<span class="sd">    Output</span>
<span class="sd">    ----------</span>
<span class="sd">    grid: Pyart Gridded object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Read in the first file</span>
    <span class="n">dow7_radar</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cfradial</span><span class="p">(</span><span class="n">dow7_file</span><span class="p">)</span>
    
    <span class="c1"># Read in the second file</span>
    <span class="n">dow6_radar</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_cfradial</span><span class="p">(</span><span class="n">dow6_file</span><span class="p">)</span>
    
    <span class="c1"># Create tuple with radars</span>
    <span class="n">radars</span> <span class="o">=</span> <span class="p">(</span><span class="n">dow7_radar</span><span class="p">,</span> <span class="n">dow6_radar</span><span class="p">)</span>
    
    <span class="c1"># Grab DOW7 latitude and longitude information</span>
    
    <span class="n">grid_lat</span> <span class="o">=</span> <span class="n">dow7_radar</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">grid_lon</span> <span class="o">=</span> <span class="n">dow7_radar</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#grid_lat = dow7_radar.latitude[&#39;data&#39;][0]</span>
    <span class="c1">#grid_lon = dow7_radar.longitude[&#39;data&#39;][0]</span>
    
    <span class="n">roi</span> <span class="o">=</span> <span class="mi">1500</span>
    
    <span class="n">dow6_grid</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">grid_from_radars</span><span class="p">(</span><span class="n">dow6_radar</span><span class="p">,</span> 
                                           <span class="n">grid_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">121</span><span class="p">),</span>
                                           <span class="n">grid_limits</span><span class="o">=</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span> <span class="mi">15000</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">)),</span>
                                           <span class="n">grid_origin</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid_lat</span><span class="p">,</span> <span class="n">grid_lon</span><span class="p">),</span>
                                           <span class="n">grid_origin_alt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                           <span class="n">weighting_function</span><span class="o">=</span><span class="s1">&#39;Barnes2&#39;</span><span class="p">,</span>
                                           <span class="c1">#roi_func=&#39;dist&#39;, xy_factor=factor, z_factor=factor,</span>
                                           <span class="n">roi_func</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant_roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> 
                                           <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ZM&#39;</span><span class="p">,</span> <span class="s1">&#39;VM&#39;</span><span class="p">])</span>
    
    <span class="n">dow7_grid</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">grid_from_radars</span><span class="p">(</span><span class="n">dow7_radar</span><span class="p">,</span>
                                           <span class="n">grid_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">121</span><span class="p">),</span>
                                           <span class="n">grid_limits</span><span class="o">=</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span> <span class="mi">15000</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">)),</span>
                                           <span class="n">grid_origin</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid_lat</span><span class="p">,</span> <span class="n">grid_lon</span><span class="p">),</span>
                                           <span class="n">weighting_function</span><span class="o">=</span><span class="s1">&#39;Barnes2&#39;</span><span class="p">,</span>
                                           <span class="n">grid_origin_alt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                           <span class="n">roi_func</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant_roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> 
                                           <span class="c1">#roi_func=&#39;dist&#39;, xy_factor=factor, z_factor=factor,</span>
                                           <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ZM&#39;</span><span class="p">,</span> <span class="s1">&#39;VM&#39;</span><span class="p">])</span>
    
    <span class="n">comp_grid</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">grid_from_radars</span><span class="p">(</span><span class="n">radars</span><span class="p">,</span>
                                           <span class="n">grid_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">121</span><span class="p">),</span>
                                           <span class="n">grid_limits</span><span class="o">=</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span> <span class="mi">15000</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">30000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">)),</span>
                                           <span class="n">grid_origin</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid_lat</span><span class="p">,</span> <span class="n">grid_lon</span><span class="p">),</span>
                                           <span class="n">grid_origin_alt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                                           <span class="n">weighting_function</span><span class="o">=</span><span class="s1">&#39;Barnes2&#39;</span><span class="p">,</span>
                                           <span class="c1">#roi_func=&#39;dist&#39;, xy_factor=factor, z_factor=factor,</span>
                                           <span class="n">roi_func</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant_roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> 
                                           <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ZM&#39;</span><span class="p">])</span>
    
    <span class="n">dow7_zm</span> <span class="o">=</span> <span class="n">dow7_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;ZM&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
    <span class="n">dow6_zm</span> <span class="o">=</span> <span class="n">dow6_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;ZM&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
    <span class="n">comp_zm</span> <span class="o">=</span> <span class="n">comp_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;ZM&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
    
    <span class="n">dow7_vm</span> <span class="o">=</span> <span class="n">dow7_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;VM&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
    <span class="n">dow6_vm</span> <span class="o">=</span> <span class="n">dow6_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;VM&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
    
    <span class="n">comp_ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmask</span><span class="p">(</span><span class="n">dow7_zm</span><span class="p">),</span> <span class="n">comp_zm</span><span class="p">)</span>
    <span class="n">comp_ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmask</span><span class="p">(</span><span class="n">dow6_zm</span><span class="p">),</span> <span class="n">comp_ma</span><span class="p">)</span>
    
    <span class="c1"># Mask based on other field</span>
    <span class="n">dow7_vm_ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmask</span><span class="p">(</span><span class="n">dow6_vm</span><span class="p">),</span> <span class="n">dow7_vm</span><span class="p">)</span>
    <span class="n">dow6_vm_ma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">getmask</span><span class="p">(</span><span class="n">dow7_vm</span><span class="p">),</span> <span class="n">dow6_vm</span><span class="p">)</span>
    
    <span class="n">comp_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;ZM&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp_ma</span>
    <span class="n">dow6_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;VM&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow6_vm_ma</span>
    <span class="n">dow7_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;VM&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow7_vm_ma</span>
    
    
    <span class="n">dow7_grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;ZM_composite&#39;</span><span class="p">,</span> <span class="n">comp_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;ZM&#39;</span><span class="p">])</span>
    <span class="n">dow6_grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;ZM_composite&#39;</span><span class="p">,</span> <span class="n">comp_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;ZM&#39;</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">dow7_grid</span><span class="p">,</span> <span class="n">dow6_grid</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dual_doppler_analysis</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">smooth_param</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">use_sounding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">second_param</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s1">&#39;Nov10&#39;</span><span class="p">,</span> <span class="n">radar1</span><span class="o">=</span><span class="s1">&#39;DOW6&#39;</span><span class="p">,</span> <span class="n">radar2</span><span class="o">=</span><span class="s1">&#39;DOW7&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs dual doppler analysis using the specified times</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Read in the files</span>
    <span class="n">dow6_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">radar1</span><span class="si">}</span><span class="s1">/v</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">/*&#39;</span><span class="p">)</span>
    <span class="n">dow7_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">radar2</span><span class="si">}</span><span class="s1">/v</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">/*&#39;</span><span class="p">)</span>
    
    <span class="c1"># Read in the sounding</span>
    <span class="c1">#sounding = pyart.io.read_arm_sonde(&#39;soundings/corsondewnpnS1.b1.20181110.180000.custom.cdf&#39;)</span>
    
    <span class="c1"># Grid the radar data using the function above</span>
    
    <span class="n">dow7_grid</span><span class="p">,</span> <span class="n">dow6_grid</span> <span class="o">=</span> <span class="n">grid_radars</span><span class="p">(</span><span class="n">dow7_files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dow6_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dow7_grid</span><span class="o">.</span><span class="n">fields</span><span class="p">))</span>
    
    <span class="c1"># Make sure only one value is used for each radar lat, lon, and altitude</span>
    <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># Use ERA data to constrain the velocity field intialization</span>
    <span class="c1">#dow6_grid = pydda.constraints.make_constraint_from_era_interim(dow6_grid, vel_field=&#39;VM&#39;)</span>
    <span class="c1">#dow7_grid = pydda.constraints.make_constraint_from_era_interim(dow7_grid, vel_field=&#39;VM&#39;)</span>
    <span class="n">profile_agl</span> <span class="o">=</span> <span class="n">pyart</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">HorizontalWindProfile</span><span class="o">.</span><span class="n">from_u_and_v</span><span class="p">(</span><span class="n">alt</span><span class="p">,</span> <span class="n">uwnd</span><span class="p">,</span> <span class="n">vwnd</span><span class="p">)</span>
    <span class="n">profile_agl</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">profile_agl</span><span class="o">.</span><span class="n">height</span> <span class="o">-</span> <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">use_sounding</span><span class="p">:</span>
        
        <span class="c1"># Load sounding data and insert as an intialization</span>
        <span class="n">u_init</span><span class="p">,</span> <span class="n">v_init</span><span class="p">,</span> <span class="n">w_init</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">make_wind_field_from_profile</span><span class="p">(</span><span class="n">dow6_grid</span><span class="p">,</span> <span class="n">profile_agl</span><span class="p">,</span> <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;VM&#39;</span><span class="p">)</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Otherwise use constant wind field</span>
        <span class="n">u_init</span><span class="p">,</span> <span class="n">v_init</span><span class="p">,</span> <span class="n">w_init</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">make_constant_wind_field</span><span class="p">(</span><span class="n">dow6_grid</span><span class="p">,</span> <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;VM&#39;</span><span class="p">)</span>
        
    <span class="c1">#print(list(dow6_grid.fields))</span>
    
    <span class="n">u_back</span> <span class="o">=</span> <span class="n">profile_agl</span><span class="o">.</span><span class="n">u_wind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">v_back</span> <span class="o">=</span> <span class="n">profile_agl</span><span class="o">.</span><span class="n">v_wind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># Convert to height above ground level relative to the DOW elevation</span>
    <span class="n">z_back</span> <span class="o">=</span> <span class="n">profile_agl</span><span class="o">.</span><span class="n">height</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#- dow7_grid.origin_altitude[&#39;data&#39;]</span>
    
    <span class="c1"># Run the dual-doppler retrieval</span>
    <span class="n">new_grids</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">([</span><span class="n">dow6_grid</span><span class="p">,</span> <span class="n">dow7_grid</span><span class="p">],</span>
                                                  <span class="n">u_init</span><span class="p">,</span> <span class="n">v_init</span><span class="p">,</span> <span class="n">w_init</span><span class="p">,</span> <span class="n">vel_name</span><span class="o">=</span><span class="s1">&#39;VM&#39;</span><span class="p">,</span> <span class="n">refl_field</span><span class="o">=</span><span class="s1">&#39;ZM_composite&#39;</span><span class="p">,</span>
                                                  <span class="c1">#Co=1, Cm=1500.,</span>
                                                  <span class="n">Co</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mi">1500</span><span class="p">,</span>
                                                  <span class="n">upper_bc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                  <span class="n">Cx</span><span class="o">=</span><span class="n">second_param</span><span class="p">,</span> <span class="n">Cy</span><span class="o">=</span><span class="n">second_param</span><span class="p">,</span> <span class="c1">#Cz=second_param/10,</span>
                                                  <span class="c1">#Cb=0.00001, u_back=u_back, v_back=v_back, z_back=z_back,</span>
                                                  <span class="c1">#model_fields=[&#39;erainterim&#39;], Cmod=0.01,</span>
                                                  <span class="c1">#Cv=1e-2, Ut = 13., Vt = 1., </span>
                                                  <span class="c1">#Cmod=1e-3, model_fields=[&#39;erainterim&#39;],</span>
                                                  <span class="n">mask_outside_opt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Write the first grid to netcdf containing the dual doppler analysis</span>
    <span class="n">new_grids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">()</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;dual_output/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span>

    <span class="c1">###################################</span>
    <span class="c1"># Plot 6 km Vertical Velocity (w)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                                  <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                                                  <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                                                  <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1"> 2018 </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> UTC   6 km /n Smooth Param: </span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;plots/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/vert_velocity_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_utc_6km.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="c1"># Close out the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="c1">##############################</span>
    <span class="c1"># Plot 3 km Vertical Velocity</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                                                  <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">17</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                                                  <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                  <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1"> 2018 </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> UTC   3 km /n Smooth Param: </span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;plots/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/vert_velocity_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_utc_3km.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="c1">#############################</span>
    <span class="c1"># Plot 3 km Reflectivity</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;ZM_composite&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                                                  <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                                                  <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                  <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1"> 2018 </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> UTC   3 km&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;plots/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/reflectivity_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_utc_3km.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="c1">#############################</span>
    <span class="c1"># Plot 3 km Radial Velocity</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;VM&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                  <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                                                  <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                  <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;10 November 2018 </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> UTC   3 km&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;plots/vel_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_utc_3km.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">new_grids</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="iop4-10-november-case">
<h2>IOP4 10 November Case<a class="headerlink" href="#iop4-10-november-case" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1954&#39;</span><span class="p">,</span> <span class="s1">&#39;1957&#39;</span><span class="p">,</span> <span class="s1">&#39;2001&#39;</span><span class="p">,</span> <span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">,</span> <span class="s1">&#39;2017&#39;</span><span class="p">,</span> <span class="s1">&#39;2021&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2007&#39;</span><span class="p">,</span> <span class="s1">&#39;2012&#39;</span><span class="p">,</span> <span class="s1">&#39;2014&#39;</span><span class="p">,</span> <span class="s1">&#39;2021&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
    <span class="n">new_grids</span> <span class="o">=</span> <span class="n">dual_doppler_analysis</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">smooth_param</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_sounding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">second_param</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ZM&#39;, &#39;VM&#39;, &#39;ROI&#39;, &#39;ZM_composite&#39;]
Calculating weights for radars 0 and 1
Calculating weights for models...
Starting solver 
rmsVR = 19.03594174450314
Total points: 167348
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:408: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:409: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:419: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:420: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|2385.7804| 563.8219|3011.2799|   0.0000|   0.0000|   0.0000|   0.0000|  24.4185
Norm of gradient: 0.26965198969701404
Iterations before filter: 10
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1181.4085| 346.3609|2070.6446|   0.0000|   0.0000|   0.0000|   0.0000|  23.4440
Norm of gradient: 0.2056178922401188
Iterations before filter: 20
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 896.4463| 317.1363|1700.7667|   0.0000|   0.0000|   0.0000|   0.0000|  23.7292
Norm of gradient: 0.09270840757062238
Iterations before filter: 30
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 789.1178| 266.9600|1503.2391|   0.0000|   0.0000|   0.0000|   0.0000|  23.7720
Norm of gradient: 0.07145387099594375
Iterations before filter: 40
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 716.7098| 260.5924|1390.5651|   0.0000|   0.0000|   0.0000|   0.0000|  23.9526
Norm of gradient: 0.027847728649060884
Iterations before filter: 50
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 663.8567| 236.9330|1330.7616|   0.0000|   0.0000|   0.0000|   0.0000|  23.6810
Norm of gradient: 0.04970064559051249
Iterations before filter: 60
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 632.2378| 230.3709|1267.0442|   0.0000|   0.0000|   0.0000|   0.0000|  23.6778
Norm of gradient: 0.05032325372251866
Iterations before filter: 70
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 620.4242| 214.5341|1211.2242|   0.0000|   0.0000|   0.0000|   0.0000|  23.3791
Norm of gradient: 0.017713028436688833
Iterations before filter: 80
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 602.7136| 211.9196|1170.8601|   0.0000|   0.0000|   0.0000|   0.0000|  23.3737
Norm of gradient: 0.023094404881194068
Iterations before filter: 90
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 597.3454| 200.7072|1137.8073|   0.0000|   0.0000|   0.0000|   0.0000|  23.1141
Norm of gradient: 0.0063613651660078905
Iterations before filter: 100
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 579.3498| 199.1999|1116.3079|   0.0000|   0.0000|   0.0000|   0.0000|  23.0791
Norm of gradient: 0.015206142832890027
Iterations before filter: 110
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 585.8276| 189.2797|1088.8775|   0.0000|   0.0000|   0.0000|   0.0000|  22.7895
Norm of gradient: 0.011947512369457331
Iterations before filter: 120
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 568.8100| 189.9797|1072.1477|   0.0000|   0.0000|   0.0000|   0.0000|  22.7839
Norm of gradient: 0.014086234869916888
Iterations before filter: 130
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 566.2892| 181.9888|1052.9029|   0.0000|   0.0000|   0.0000|   0.0000|  22.5281
Norm of gradient: 0.011518091125647275
Iterations before filter: 140
Applying low pass filter to wind field...
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1200.7276| 137.6723| 979.8800|   0.0000|   0.0000|   0.0000|   0.0000|  15.4163
Norm of gradient: 0.1428517733483083
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1189.5929| 137.7142| 975.0434|   0.0000|   0.0000|   0.0000|   0.0000|  15.4377
Norm of gradient: 0.12512514894422816
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 766.3067| 165.8939|1062.1570|   0.0000|   0.0000|   0.0000|   0.0000|  17.2217
Norm of gradient: 0.44617253672092316
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 654.0598| 184.3512|1334.7118|   0.0000|   0.0000|   0.0000|   0.0000|  18.3592
Norm of gradient: 0.7716539804507561
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 720.7249| 170.0813|1029.5911|   0.0000|   0.0000|   0.0000|   0.0000|  17.6200
Norm of gradient: 0.10717367157183733
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 741.9438| 164.0900| 987.6000|   0.0000|   0.0000|   0.0000|   0.0000|  17.5058
Norm of gradient: 0.08143157305612776
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 721.1884| 164.2323| 979.3928|   0.0000|   0.0000|   0.0000|   0.0000|  17.8581
Norm of gradient: 0.061792056889757266
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 643.1934| 176.6913|1024.1694|   0.0000|   0.0000|   0.0000|   0.0000|  19.0394
Norm of gradient: 0.11598064089086615
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 624.6354| 180.5768|1020.4126|   0.0000|   0.0000|   0.0000|   0.0000|  19.3466
Norm of gradient: 0.038800631262407695
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 613.6000| 182.8277|1024.0315|   0.0000|   0.0000|   0.0000|   0.0000|  19.5347
Norm of gradient: 0.022732182461436382
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 596.7959| 186.1320|1030.9836|   0.0000|   0.0000|   0.0000|   0.0000|  19.9045
Norm of gradient: 0.041083610262878906
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 576.7002| 190.1544|1040.8888|   0.0000|   0.0000|   0.0000|   0.0000|  20.5545
Norm of gradient: 0.04459946235241034
Iterations after filter: 1
Iterations after filter: 2
Done! Time = 87.7
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ZM&#39;, &#39;VM&#39;, &#39;ROI&#39;, &#39;ZM_composite&#39;]
Calculating weights for radars 0 and 1
Calculating weights for models...
Starting solver 
rmsVR = 15.114126801162826
Total points: 142166
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:408: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:409: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:419: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:420: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|2660.2645| 565.0598|3533.4481|   0.0000|   0.0000|   0.0000|   0.0000|  33.9547
Norm of gradient: 0.1378636703981757
Iterations before filter: 10
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1118.9704| 386.6984|2466.7303|   0.0000|   0.0000|   0.0000|   0.0000|  31.5961
Norm of gradient: 0.10130368903703041
Iterations before filter: 20
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 949.9282| 317.3620|1942.9976|   0.0000|   0.0000|   0.0000|   0.0000|  33.7857
Norm of gradient: 0.03370152004001552
Iterations before filter: 30
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 860.8240| 272.4921|1756.6272|   0.0000|   0.0000|   0.0000|   0.0000|  32.4604
Norm of gradient: 0.03590783323620595
Iterations before filter: 40
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 782.7759| 252.9373|1632.4298|   0.0000|   0.0000|   0.0000|   0.0000|  34.6054
Norm of gradient: 0.044452682235541545
Iterations before filter: 50
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 759.8727| 231.0059|1544.2291|   0.0000|   0.0000|   0.0000|   0.0000|  33.5941
Norm of gradient: 0.06889431241931993
Iterations before filter: 60
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 729.1434| 225.5021|1473.6133|   0.0000|   0.0000|   0.0000|   0.0000|  35.0392
Norm of gradient: 0.04044140410559862
Iterations before filter: 70
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 722.4413| 210.6913|1413.3714|   0.0000|   0.0000|   0.0000|   0.0000|  34.3624
Norm of gradient: 0.020879348492745357
Iterations before filter: 80
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 700.5925| 207.6170|1374.4724|   0.0000|   0.0000|   0.0000|   0.0000|  35.5806
Norm of gradient: 0.020770671204342023
Iterations before filter: 90
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 695.4625| 197.9551|1340.6321|   0.0000|   0.0000|   0.0000|   0.0000|  34.9556
Norm of gradient: 0.008006754772193567
Iterations before filter: 100
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 682.3125| 195.7283|1310.1148|   0.0000|   0.0000|   0.0000|   0.0000|  35.9546
Norm of gradient: 0.011204301682504083
Iterations before filter: 110
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 680.4659| 188.1285|1284.7154|   0.0000|   0.0000|   0.0000|   0.0000|  35.3193
Norm of gradient: 0.006399805443678243
Iterations before filter: 120
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 667.1409| 183.9229|1264.2836|   0.0000|   0.0000|   0.0000|   0.0000|  35.8136
Norm of gradient: 0.01557917522863525
Iterations before filter: 130
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 666.8705| 179.0928|1227.6108|   0.0000|   0.0000|   0.0000|   0.0000|  35.8747
Norm of gradient: 0.039284041303490946
Iterations before filter: 140
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 654.6403| 175.1364|1208.6149|   0.0000|   0.0000|   0.0000|   0.0000|  36.0915
Norm of gradient: 0.008847126284513014
Iterations before filter: 150
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 657.2883| 170.3108|1183.0131|   0.0000|   0.0000|   0.0000|   0.0000|  35.9987
Norm of gradient: 0.01859422921258853
Iterations before filter: 160
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 644.5606| 168.0423|1171.9550|   0.0000|   0.0000|   0.0000|   0.0000|  36.2549
Norm of gradient: 0.006872963286791082
Iterations before filter: 170
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 652.2107| 161.6995|1135.1166|   0.0000|   0.0000|   0.0000|   0.0000|  36.0821
Norm of gradient: 0.016204911703462357
Iterations before filter: 180
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 634.0205| 159.2911|1127.1341|   0.0000|   0.0000|   0.0000|   0.0000|  36.4078
Norm of gradient: 0.004024582168366484
Iterations before filter: 190
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 635.2694| 155.5699|1097.5382|   0.0000|   0.0000|   0.0000|   0.0000|  36.5954
Norm of gradient: 0.013818497911772918
Iterations before filter: 200
Applying low pass filter to wind field...
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1654.2579|  89.7056| 996.0122|   0.0000|   0.0000|   0.0000|   0.0000|  20.3311
Norm of gradient: 0.2127773186755198
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1629.2807|  89.7321| 988.9909|   0.0000|   0.0000|   0.0000|   0.0000|  20.3428
Norm of gradient: 0.209903953040575
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 911.1799| 131.6864|1113.6528|   0.0000|   0.0000|   0.0000|   0.0000|  25.7405
Norm of gradient: 0.37286245910682675
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 753.3706| 160.6752|1580.3824|   0.0000|   0.0000|   0.0000|   0.0000|  30.6181
Norm of gradient: 0.7989236912916559
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 846.5253| 137.6900|1071.9508|   0.0000|   0.0000|   0.0000|   0.0000|  27.3158
Norm of gradient: 0.10784046394826906
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 862.5901| 130.5764|1026.8507|   0.0000|   0.0000|   0.0000|   0.0000|  27.0297
Norm of gradient: 0.07986213503179665
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 829.3796| 130.4495|1016.0622|   0.0000|   0.0000|   0.0000|   0.0000|  28.4707
Norm of gradient: 0.06221117802586161
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 727.5910| 147.0902|1080.3474|   0.0000|   0.0000|   0.0000|   0.0000|  32.6543
Norm of gradient: 0.12154829550316731
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 711.1430| 150.2747|1065.7925|   0.0000|   0.0000|   0.0000|   0.0000|  33.2876
Norm of gradient: 0.035709100023258944
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 696.5285| 153.2016|1069.8960|   0.0000|   0.0000|   0.0000|   0.0000|  33.8928
Norm of gradient: 0.026858419157479593
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 674.1206| 157.6951|1077.6219|   0.0000|   0.0000|   0.0000|   0.0000|  35.0192
Norm of gradient: 0.03230576187821094
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 655.5862| 161.8357|1081.6356|   0.0000|   0.0000|   0.0000|   0.0000|  36.4056
Norm of gradient: 0.040760719296840775
Iterations after filter: 1
Iterations after filter: 2
Done! Time = 113.7
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ZM&#39;, &#39;VM&#39;, &#39;ROI&#39;, &#39;ZM_composite&#39;]
Calculating weights for radars 0 and 1
Calculating weights for models...
Starting solver 
rmsVR = 13.496556932974375
Total points: 130276
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:408: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:409: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:419: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:420: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|2348.8622| 742.5180|4072.3844|   0.0000|   0.0000|   0.0000|   0.0000|  29.6148
Norm of gradient: 0.16394739941319164
Iterations before filter: 10
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1215.4138| 457.1836|2656.1494|   0.0000|   0.0000|   0.0000|   0.0000|  28.1556
Norm of gradient: 0.05811384888038545
Iterations before filter: 20
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 962.6794| 380.8780|2266.2197|   0.0000|   0.0000|   0.0000|   0.0000|  32.4424
Norm of gradient: 0.21080547319561793
Iterations before filter: 30
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 871.9432| 320.2638|1908.1383|   0.0000|   0.0000|   0.0000|   0.0000|  30.9040
Norm of gradient: 0.02147858357243421
Iterations before filter: 40
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 810.1526| 302.4323|1771.1405|   0.0000|   0.0000|   0.0000|   0.0000|  32.7816
Norm of gradient: 0.023068403350740427
Iterations before filter: 50
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 789.8849| 269.1216|1672.4541|   0.0000|   0.0000|   0.0000|   0.0000|  31.9280
Norm of gradient: 0.030279090860364295
Iterations before filter: 60
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 746.2419| 260.9243|1622.3280|   0.0000|   0.0000|   0.0000|   0.0000|  33.3533
Norm of gradient: 0.05092919543016084
Iterations before filter: 70
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 754.1833| 241.0865|1543.4696|   0.0000|   0.0000|   0.0000|   0.0000|  32.9423
Norm of gradient: 0.015663634036932675
Iterations before filter: 80
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 729.3557| 237.9571|1503.8305|   0.0000|   0.0000|   0.0000|   0.0000|  34.1102
Norm of gradient: 0.019107812774741623
Iterations before filter: 90
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 731.2199| 224.9792|1466.2241|   0.0000|   0.0000|   0.0000|   0.0000|  33.7108
Norm of gradient: 0.008897447584644728
Iterations before filter: 100
Applying low pass filter to wind field...
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|2122.0540| 146.9797|1396.3226|   0.0000|   0.0000|   0.0000|   0.0000|  24.9075
Norm of gradient: 0.2904910461608383
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|2080.4643| 147.0437|1386.2431|   0.0000|   0.0000|   0.0000|   0.0000|  24.9345
Norm of gradient: 0.2674584229250857
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1050.0424| 201.4075|1537.4854|   0.0000|   0.0000|   0.0000|   0.0000|  26.1567
Norm of gradient: 0.289383348563477
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 858.3126| 237.0235|2179.7708|   0.0000|   0.0000|   0.0000|   0.0000|  27.8748
Norm of gradient: 0.7664430992523129
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 968.0289| 207.9678|1479.1873|   0.0000|   0.0000|   0.0000|   0.0000|  26.6696
Norm of gradient: 0.11669631526235033
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 982.4417| 199.8295|1425.5064|   0.0000|   0.0000|   0.0000|   0.0000|  26.6338
Norm of gradient: 0.07911152077737238
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 940.0794| 199.5582|1405.8623|   0.0000|   0.0000|   0.0000|   0.0000|  27.2158
Norm of gradient: 0.060380738323319916
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 819.2467| 221.0171|1478.4367|   0.0000|   0.0000|   0.0000|   0.0000|  28.7322
Norm of gradient: 0.1569248250858718
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 799.3745| 224.7627|1455.5369|   0.0000|   0.0000|   0.0000|   0.0000|  28.9472
Norm of gradient: 0.05054362337466886
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 780.7967| 228.6284|1458.8744|   0.0000|   0.0000|   0.0000|   0.0000|  29.1820
Norm of gradient: 0.03323622289657599
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 755.4370| 234.6121|1463.6163|   0.0000|   0.0000|   0.0000|   0.0000|  29.6081
Norm of gradient: 0.03352764783680135
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 739.0881| 240.1346|1458.6793|   0.0000|   0.0000|   0.0000|   0.0000|  30.0905
Norm of gradient: 0.04168860539869632
Iterations after filter: 1
Iterations after filter: 2
Done! Time = 67.6
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ZM&#39;, &#39;VM&#39;, &#39;ROI&#39;, &#39;ZM_composite&#39;]
Calculating weights for radars 0 and 1
Calculating weights for models...
Starting solver 
rmsVR = 15.404588782409398
Total points: 144184
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:408: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:409: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:419: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:420: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|4191.1339| 881.0547|4223.5028|   0.0000|   0.0000|   0.0000|   0.0000|  30.8509
Norm of gradient: 0.1256154879734669
Iterations before filter: 10
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|2070.3606| 685.2602|3042.8861|   0.0000|   0.0000|   0.0000|   0.0000|  25.7752
Norm of gradient: 0.04792967940402924
Iterations before filter: 20
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1620.2912| 579.3535|2563.0267|   0.0000|   0.0000|   0.0000|   0.0000|  26.9963
Norm of gradient: 0.061709362199629664
Iterations before filter: 30
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1547.6806| 485.1756|2370.0348|   0.0000|   0.0000|   0.0000|   0.0000|  25.3269
Norm of gradient: 0.08645502175009437
Iterations before filter: 40
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1432.3378| 457.6403|2240.4885|   0.0000|   0.0000|   0.0000|   0.0000|  26.2232
Norm of gradient: 0.04855832842610265
Iterations before filter: 50
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1452.7172| 394.7777|2097.7443|   0.0000|   0.0000|   0.0000|   0.0000|  26.4830
Norm of gradient: 0.031458551474678
Iterations before filter: 60
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1354.3945| 375.3238|2051.9142|   0.0000|   0.0000|   0.0000|   0.0000|  27.0166
Norm of gradient: 0.023949723195245097
Iterations before filter: 70
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1339.8107| 340.2173|1978.1810|   0.0000|   0.0000|   0.0000|   0.0000|  29.3041
Norm of gradient: 0.07107508314872382
Iterations before filter: 80
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1306.7548| 323.3018|1925.1992|   0.0000|   0.0000|   0.0000|   0.0000|  29.5808
Norm of gradient: 0.022787764622197962
Iterations before filter: 90
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1309.2749| 294.5999|1862.3249|   0.0000|   0.0000|   0.0000|   0.0000|  31.0719
Norm of gradient: 0.020525627000723405
Iterations before filter: 100
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1280.7965| 287.1073|1844.9521|   0.0000|   0.0000|   0.0000|   0.0000|  31.2436
Norm of gradient: 0.01236608856213324
Iterations before filter: 110
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1293.0073| 262.4049|1793.2551|   0.0000|   0.0000|   0.0000|   0.0000|  32.3819
Norm of gradient: 0.015513330589888519
Iterations before filter: 120
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1260.6391| 257.9080|1782.1509|   0.0000|   0.0000|   0.0000|   0.0000|  32.4921
Norm of gradient: 0.005769090353404301
Iterations before filter: 130
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1273.7381| 240.3974|1742.6648|   0.0000|   0.0000|   0.0000|   0.0000|  33.1043
Norm of gradient: 0.011918077115545607
Iterations before filter: 140
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1248.8074| 237.8157|1735.2304|   0.0000|   0.0000|   0.0000|   0.0000|  33.1750
Norm of gradient: 0.006652549590620723
Iterations before filter: 150
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1254.9401| 231.3909|1720.8211|   0.0000|   0.0000|   0.0000|   0.0000|  33.2990
Norm of gradient: 0.016365352005926773
Iterations before filter: 160
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1243.9046| 230.5602|1718.3368|   0.0000|   0.0000|   0.0000|   0.0000|  33.3484
Norm of gradient: 0.002666858179271438
Iterations before filter: 170
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1250.5334| 223.7709|1701.3022|   0.0000|   0.0000|   0.0000|   0.0000|  33.4584
Norm of gradient: 0.0137201611486545
Iterations before filter: 180
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1240.5683| 223.3843|1699.3664|   0.0000|   0.0000|   0.0000|   0.0000|  33.4913
Norm of gradient: 0.0021068553840788563
Iterations before filter: 190
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1243.7845| 215.6400|1687.4606|   0.0000|   0.0000|   0.0000|   0.0000|  33.5896
Norm of gradient: 0.01620072171787526
Iterations before filter: 200
Applying low pass filter to wind field...
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|2582.4272| 141.2081|1659.6692|   0.0000|   0.0000|   0.0000|   0.0000|  31.7632
Norm of gradient: 0.22909408797832714
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|2550.4785| 140.9991|1642.6785|   0.0000|   0.0000|   0.0000|   0.0000|  31.7609
Norm of gradient: 0.21197052186375998
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1711.6917| 188.1008|1659.2943|   0.0000|   0.0000|   0.0000|   0.0000|  31.6190
Norm of gradient: 0.4711054388356092
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1481.8021| 220.0327|2267.6799|   0.0000|   0.0000|   0.0000|   0.0000|  31.5315
Norm of gradient: 0.9151327129202761
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1612.5988| 194.3738|1590.1617|   0.0000|   0.0000|   0.0000|   0.0000|  31.5887
Norm of gradient: 0.14066595086587347
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1614.6862| 183.4431|1545.0922|   0.0000|   0.0000|   0.0000|   0.0000|  31.5918
Norm of gradient: 0.07087261978240864
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1537.7328| 183.1647|1570.5543|   0.0000|   0.0000|   0.0000|   0.0000|  31.5638
Norm of gradient: 0.06845955879262619
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1355.9944| 202.0002|1693.8886|   0.0000|   0.0000|   0.0000|   0.0000|  31.4914
Norm of gradient: 0.1343425471597947
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1325.1426| 208.3546|1687.4030|   0.0000|   0.0000|   0.0000|   0.0000|  31.4727
Norm of gradient: 0.04504796132573377
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1315.9811| 211.4567|1683.6636|   0.0000|   0.0000|   0.0000|   0.0000|  31.4636
Norm of gradient: 0.03311283239367466
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1298.2359| 217.0663|1682.6580|   0.0000|   0.0000|   0.0000|   0.0000|  31.4407
Norm of gradient: 0.048951364921909934
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|1280.3195| 225.4955|1682.8383|   0.0000|   0.0000|   0.0000|   0.0000|  31.3845
Norm of gradient: 0.06556345531480742
Iterations after filter: 1
Iterations after filter: 2
Done! Time = 111.9
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_14_16.png" src="_images/dual_doppler_analysis_14_16.png" />
<img alt="_images/dual_doppler_analysis_14_17.png" src="_images/dual_doppler_analysis_14_17.png" />
<img alt="_images/dual_doppler_analysis_14_18.png" src="_images/dual_doppler_analysis_14_18.png" />
<img alt="_images/dual_doppler_analysis_14_19.png" src="_images/dual_doppler_analysis_14_19.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow6_grid</span><span class="p">,</span> <span class="n">dow7_grid</span> <span class="o">=</span> <span class="n">new_grids</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span> <span class="o">=</span> <span class="n">new_grids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">dow6_dda</span> <span class="o">=</span> <span class="n">new_grids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

<span class="n">dow7_dda</span> <span class="o">=</span> <span class="n">dow7_dda</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">ZM</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dow6_dda</span><span class="o">.</span><span class="n">ZM</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;ZM&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                  <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                                                  <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                  <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

<span class="c1">#plt.title(f&#39;{case} 2018 {time} UTC   3 km&#39;, fontsize=16)</span>

<span class="c1">#plt.savefig(f&#39;plots/{case}/reflectivity_{time}_utc_3km.png&#39;, dpi=200)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_17_1.png" src="_images/dual_doppler_analysis_17_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span><span class="o">.</span><span class="n">ZM</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fe584ffbed0&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_18_1.png" src="_images/dual_doppler_analysis_18_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">14000</span><span class="p">)</span><span class="o">.</span><span class="n">ZM_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
<span class="n">dow7_dda</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">w</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">14000</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>
<span class="n">dow7_dda</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">w</span><span class="o">&lt;-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">14000</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues_r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.contour.QuadContourSet at 0x7fe58524c090&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_19_1.png" src="_images/dual_doppler_analysis_19_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow6_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span><span class="o">.</span><span class="n">ZM_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fae81d9bc10&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_20_1.png" src="_images/dual_doppler_analysis_20_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow6_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">14000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7fae84390b50&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_21_1.png" src="_images/dual_doppler_analysis_21_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">VM</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fae7fef7310&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_22_1.png" src="_images/dual_doppler_analysis_22_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fae80594910&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_23_1.png" src="_images/dual_doppler_analysis_23_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow6_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">ZM_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fae7c4e5a90&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_24_1.png" src="_images/dual_doppler_analysis_24_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow6_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span><span class="o">.</span><span class="n">ZM_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 12000.0)
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_25_1.png" src="_images/dual_doppler_analysis_25_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">15000</span><span class="p">)</span><span class="o">.</span><span class="n">ZM_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
<span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">15000</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fae80af1410&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_26_1.png" src="_images/dual_doppler_analysis_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fae7ff72f10&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_27_1.png" src="_images/dual_doppler_analysis_27_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">12000</span><span class="p">)</span><span class="o">.</span><span class="n">ZM_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
<span class="n">dow6_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">12000</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa84e2c3110&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_28_1.png" src="_images/dual_doppler_analysis_28_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow6_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 5000.0)
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_29_1.png" src="_images/dual_doppler_analysis_29_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">12500</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa837c38490&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_30_1.png" src="_images/dual_doppler_analysis_30_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">12500</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa8467c2d50&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_31_1.png" src="_images/dual_doppler_analysis_31_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa83192f890&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_32_1.png" src="_images/dual_doppler_analysis_32_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span><span class="o">.</span><span class="n">ZM_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa82604da10&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_33_1.png" src="_images/dual_doppler_analysis_33_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_dda</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">12500</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa838d3b210&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_34_1.png" src="_images/dual_doppler_analysis_34_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span><span class="o">.</span><span class="n">ZM</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa82a322c10&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_35_1.png" src="_images/dual_doppler_analysis_35_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">height</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">new_grids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">radar_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>41.80000667572017
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;ZM_composite&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                         <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
                                         <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                         <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                         <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;cartopy.mpl.geoaxes.GeoAxesSubplot at 0x7fa82c3182d0&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_38_2.png" src="_images/dual_doppler_analysis_38_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_grids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">point_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[500., 500., 500., ..., 500., 500., 500.],
       [500., 500., 500., ..., 500., 500., 500.],
       [500., 500., 500., ..., 500., 500., 500.],
       ...,
       [500., 500., 500., ..., 500., 500., 500.],
       [500., 500., 500., ..., 500., 500., 500.],
       [500., 500., 500., ..., 500., 500., 500.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a vertical X-Z cross section</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;ZM_composite&#39;</span><span class="p">,</span>
                                     <span class="n">level</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">w_vel_contours</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/vis/quiver_plot.py:213: UserWarning: linewidths is ignored by contourf
  alpha=contour_alpha)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/git_repos/PyDDA/pydda/vis/quiver_plot.py:247: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  levels=[bca_min, bca_max], color=&#39;k&#39;)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/git_repos/PyDDA/pydda/vis/quiver_plot.py:247: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  levels=[bca_min, bca_max], color=&#39;k&#39;)
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_40_1.png" src="_images/dual_doppler_analysis_40_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a vertical X-Z cross section</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_xz_xsection_quiver</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;ZM_composite&#39;</span><span class="p">,</span>
                                 <span class="n">level</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
                                 <span class="n">w_vel_contours</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                  <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
                                  <span class="n">quiver_spacing_z_km</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                  <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dual_doppler_analysis_41_0.png" src="_images/dual_doppler_analysis_41_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a vertical X-Z cross section</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_xz_xsection_quiver</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;ZM_composite&#39;</span><span class="p">,</span>
                                 <span class="n">level</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
                                 <span class="n">w_vel_contours</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                  <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
                                  <span class="n">quiver_spacing_z_km</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span>
                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                  <span class="n">vmin</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                                 <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dual_doppler_analysis_42_0.png" src="_images/dual_doppler_analysis_42_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">new_grids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">13000</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa832aee490&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_44_1.png" src="_images/dual_doppler_analysis_44_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mi">6000</span><span class="p">)</span><span class="o">.</span><span class="n">ZM_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa83339c590&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_45_1.png" src="_images/dual_doppler_analysis_45_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">12500</span><span class="p">)</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa835c3b190&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_46_1.png" src="_images/dual_doppler_analysis_46_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lev</span> <span class="o">=</span> <span class="mi">7000</span>
<span class="n">grid</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">lev</span><span class="p">)</span><span class="o">.</span><span class="n">ZM_composite</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">w</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">lev</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">w</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="n">lev</span><span class="p">)</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fa836024050&gt;
</pre></div>
</div>
<img alt="_images/dual_doppler_analysis_47_1.png" src="_images/dual_doppler_analysis_47_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
    <span class="n">dual_doppler_analysis</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">smooth_param</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_sounding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">second_param</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ZM&#39;, &#39;VM&#39;, &#39;ROI&#39;, &#39;ZM_composite&#39;]
Interpolating sounding to radar grid
Interpolated U field:
[ 0.61185031 -1.47755905 -3.11542971  1.27490636  0.98365897  4.59610825
 11.56590905 13.22328765 14.42246695 16.88097903 16.26198126 15.486934
 24.26524903 29.94361949 33.6408602  33.91002067 33.26630542 34.42432932
 35.36828193 40.26716417 41.88335986 43.37174393 45.39279215 49.89085485
 51.89810168 51.09769665 40.63088394 38.73612332 36.24062356 37.56390412
 27.50475448]
Interpolated V field:
[ -5.26070678  -8.5         -7.74726563  -7.42471909  -1.2941386
   1.26006765  -0.84951296  -8.46149163  -9.87958884  -9.80951048
  -9.63306558  -8.92690818  -3.74969622  -8.04733177  -9.4311828
 -11.65330578 -14.23044334 -16.79278447 -14.92537446 -12.47014927
 -10.19522294  -9.81883738  -8.08481457  -7.78336648  -7.81769745
  -9.82140454   0.88509051  -4.98340675  -0.51205871   3.52406392
   4.50007798]
Grid levels:
[    0.   500.  1000.  1500.  2000.  2500.  3000.  3500.  4000.  4500.
  5000.  5500.  6000.  6500.  7000.  7500.  8000.  8500.  9000.  9500.
 10000. 10500. 11000. 11500. 12000. 12500. 13000. 13500. 14000. 14500.
 15000.]
Calculating weights for radars 0 and 1
Calculating weights for models...
Starting solver 
rmsVR = 20.748899638557944
Total points: 203787
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:408: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:409: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:419: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:420: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|31571.3042|  33.6316|20742.5778|  31.5501|   0.0000|   0.0000|   0.0000|   5.7617
Norm of gradient: 1.48853292906004
Iterations before filter: 10
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|15573.0582| 262.7996|13843.3908|  70.1656|   0.0000|   0.0000|   0.0000|  16.9809
Norm of gradient: 0.47370527232067056
Iterations before filter: 20
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|13592.2172| 330.3698|9118.7278|  78.0776|   0.0000|   0.0000|   0.0000|  19.5098
Norm of gradient: 0.20757479731910652
Iterations before filter: 30
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|10190.7992| 487.4735|9157.6109|  97.2364|   0.0000|   0.0000|   0.0000|  24.4880
Norm of gradient: 0.43336046078081397
Iterations before filter: 40
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|9575.0206| 543.6499|7723.6027| 105.1525|   0.0000|   0.0000|   0.0000|  26.2811
Norm of gradient: 0.18817372003299399
Iterations before filter: 50
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|8235.4327| 646.6531|7694.9368| 117.4818|   0.0000|   0.0000|   0.0000|  29.3711
Norm of gradient: 0.25028279630078826
Iterations before filter: 60
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|8043.5445| 676.6428|6947.9072| 121.7306|   0.0000|   0.0000|   0.0000|  30.3602
Norm of gradient: 0.08771931304200828
Iterations before filter: 70
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|7279.2288| 750.4795|6909.7738| 130.9263|   0.0000|   0.0000|   0.0000|  32.7090
Norm of gradient: 0.08472728964816935
Iterations before filter: 80
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|7208.0899| 766.9357|6444.3950| 133.5794|   0.0000|   0.0000|   0.0000|  33.3331
Norm of gradient: 0.11231365381270392
Iterations before filter: 90
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|6896.6080| 794.1754|6397.3635| 137.3280|   0.0000|   0.0000|   0.0000|  34.3543
Norm of gradient: 0.1573375347164585
Iterations before filter: 100
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|6764.8440| 818.3751|6170.6504| 141.3587|   0.0000|   0.0000|   0.0000|  35.3335
Norm of gradient: 0.12371648539743063
Iterations before filter: 110
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|6617.6274| 826.8555|6031.3643| 142.5987|   0.0000|   0.0000|   0.0000|  35.7029
Norm of gradient: 0.03724475150710924
Iterations before filter: 120
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|6454.5022| 852.4353|5872.7575| 147.1010|   0.0000|   0.0000|   0.0000|  36.8066
Norm of gradient: 0.06588787031732482
Iterations before filter: 130
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|6325.0864| 860.8269|5754.1528| 148.5697|   0.0000|   0.0000|   0.0000|  37.2212
Norm of gradient: 0.07474420371084677
Iterations before filter: 140
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|6009.6687| 912.4590|5574.8414| 158.1301|   0.0000|   0.0000|   0.0000|  39.4422
Norm of gradient: 0.16677426737873463
Iterations before filter: 150
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR:root:Internal Python error in the inspect module.
Below is the traceback from this internal error.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/interactiveshell.py&quot;, line 3331, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File &quot;&lt;ipython-input-15-4b869932aad0&gt;&quot;, line 2, in &lt;module&gt;
    dual_doppler_analysis(time, smooth_param=0.5, use_sounding=True, second_param=0.01)
  File &quot;&lt;ipython-input-11-6cd94a096c02&gt;&quot;, line 58, in dual_doppler_analysis
    mask_outside_opt=True)
  File &quot;/Users/mgrover/git_repos/PyDDA/pydda/retrieval/wind_retrieve.py&quot;, line 518, in get_dd_wind_field
    fprime=grad_J, disp=0, iprint=-1)
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/lbfgsb.py&quot;, line 198, in fmin_l_bfgs_b
    **opts)
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/lbfgsb.py&quot;, line 360, in _minimize_lbfgsb
    f, g = func_and_grad(x)
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py&quot;, line 201, in fun_and_grad
    self._update_grad()
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py&quot;, line 171, in _update_grad
    self._update_grad_impl()
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py&quot;, line 85, in update_grad
    self.g = grad_wrapped(self.x)
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py&quot;, line 82, in grad_wrapped
    return np.atleast_1d(grad(x, *args))
  File &quot;/Users/mgrover/git_repos/PyDDA/pydda/cost_functions/cost_functions.py&quot;, line 121, in grad_J
    parameters.rmsVr, coeff=parameters.Co, upper_bc=parameters.upper_bc)
  File &quot;/Users/mgrover/git_repos/PyDDA/pydda/cost_functions/cost_functions.py&quot;, line 279, in calculate_grad_radial_vel
    np.sin(azs[i]) * weights[i]) * lambda_o
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/numpy/ma/core.py&quot;, line 3031, in __array_wrap__
    def __array_wrap__(self, obj, context=None):
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/interactiveshell.py&quot;, line 2044, in showtraceback
    stb = value._render_traceback_()
AttributeError: &#39;KeyboardInterrupt&#39; object has no attribute &#39;_render_traceback_&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/ultratb.py&quot;, line 1148, in get_records
    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/ultratb.py&quot;, line 316, in wrapped
    return f(*args, **kwargs)
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/ultratb.py&quot;, line 350, in _fixed_getinnerframes
    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/inspect.py&quot;, line 1502, in getinnerframes
    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/inspect.py&quot;, line 1460, in getframeinfo
    filename = getsourcefile(frame) or getfile(frame)
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/inspect.py&quot;, line 696, in getsourcefile
    if getattr(getmodule(object, filename), &#39;__loader__&#39;, None) is not None:
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/inspect.py&quot;, line 742, in getmodule
    os.path.realpath(f)] = module.__name__
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/posixpath.py&quot;, line 395, in realpath
    path, ok = _joinrealpath(filename[:0], filename, {})
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/posixpath.py&quot;, line 429, in _joinrealpath
    if not islink(newpath):
  File &quot;/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/posixpath.py&quot;, line 171, in islink
    st = os.lstat(path)
KeyboardInterrupt
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dual_doppler_analysis</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">smooth_param</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">use_sounding</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">second_param</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s1">&#39;Nov10&#39;</span><span class="p">,</span> <span class="n">radar1</span><span class="o">=</span><span class="s1">&#39;DOW6&#39;</span><span class="p">,</span> <span class="n">radar2</span><span class="o">=</span><span class="s1">&#39;DOW7&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs dual doppler analysis using the specified times</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># Read in the files</span>
    <span class="n">dow6_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">radar1</span><span class="si">}</span><span class="s1">/v</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">/*&#39;</span><span class="p">)</span>
    <span class="n">dow7_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">radar2</span><span class="si">}</span><span class="s1">/v</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">/*&#39;</span><span class="p">)</span>
    
    <span class="c1"># Read in the sounding</span>
    <span class="c1">#sounding = pyart.io.read_arm_sonde(&#39;soundings/corsondewnpnS1.b1.20181110.180000.custom.cdf&#39;)</span>
    
    <span class="c1"># Grid the radar data using the function above</span>
    
    <span class="n">dow7_grid</span><span class="p">,</span> <span class="n">dow6_grid</span> <span class="o">=</span> <span class="n">grid_radars</span><span class="p">(</span><span class="n">dow7_files</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dow6_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c1"># Make sure only one value is used for each radar lat, lon, and altitude</span>
    <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow6_grid</span><span class="o">.</span><span class="n">radar_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_altitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dow7_grid</span><span class="o">.</span><span class="n">origin_longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># Use ERA data to constrain the velocity field intialization</span>
    <span class="n">dow6_grid</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">make_constraint_from_era_interim</span><span class="p">(</span><span class="n">dow6_grid</span><span class="p">,</span> <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;VM&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">use_sounding</span><span class="p">:</span>
        
        <span class="c1"># Load sounding data and insert as an intialization</span>
        <span class="n">u_init</span><span class="p">,</span> <span class="n">v_init</span><span class="p">,</span> <span class="n">w_init</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">make_wind_field_from_profile</span><span class="p">(</span><span class="n">dow6_grid</span><span class="p">,</span> <span class="n">sounding</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;VM&#39;</span><span class="p">)</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Otherwise use constant wind field</span>
        <span class="n">u_init</span><span class="p">,</span> <span class="n">v_init</span><span class="p">,</span> <span class="n">w_init</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">initialization</span><span class="o">.</span><span class="n">make_constant_wind_field</span><span class="p">(</span><span class="n">dow6_grid</span><span class="p">,</span> <span class="n">vel_field</span><span class="o">=</span><span class="s1">&#39;VM&#39;</span><span class="p">)</span>
    
    <span class="c1"># Run the dual-doppler retrieval</span>
    <span class="n">new_grids</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">retrieval</span><span class="o">.</span><span class="n">get_dd_wind_field</span><span class="p">([</span><span class="n">dow7_grid</span><span class="p">,</span> <span class="n">dow6_grid</span><span class="p">],</span>
                                                  <span class="n">u_init</span><span class="p">,</span> <span class="n">v_init</span><span class="p">,</span> <span class="n">w_init</span><span class="p">,</span> <span class="n">vel_name</span><span class="o">=</span><span class="s1">&#39;VM&#39;</span><span class="p">,</span> <span class="n">refl_field</span><span class="o">=</span><span class="s1">&#39;ZM&#39;</span><span class="p">,</span>
                                                  <span class="n">Co</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">1000.</span><span class="p">,</span> <span class="n">Cx</span><span class="o">=</span><span class="n">second_param</span><span class="p">,</span> <span class="n">Cy</span><span class="o">=</span><span class="n">second_param</span><span class="p">,</span> <span class="n">upper_bc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                  <span class="n">Cv</span><span class="o">=</span><span class="mf">.001</span><span class="p">,</span> <span class="n">Ut</span> <span class="o">=</span> <span class="mf">7.4</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">13.34</span><span class="p">,</span>
                                                  <span class="n">mask_outside_opt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Write the first grid to netcdf containing the dual doppler analysis</span>
    <span class="n">new_grids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">()</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;dual_output/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/vort_constraint_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_smooth_param_</span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">.nc&#39;</span><span class="p">)</span>

    <span class="c1">###################################</span>
    <span class="c1"># Plot 6 km Vertical Velocity (w)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
                                                  <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                                                  <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
                                                  <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1"> 2018 </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> UTC   6 km /n Smooth Param: </span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;plots/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/vort_constraint_vert_velocity_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_utc_6km_smooth_param_</span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="c1"># Close out the figure</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="c1">##############################</span>
    <span class="c1"># Plot 3 km Vertical Velocity</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                                                  <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">17</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
                                                  <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                  <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1"> 2018 </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> UTC   3 km /n Smooth Param: </span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;plots/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/vort_constraint_vert_velocity_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_utc_3km_smooth_param_</span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="c1">#############################</span>
    <span class="c1"># Plot 3 km Reflectivity</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;ZM&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                                                  <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span>
                                                  <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                  <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;pyart_HomeyerRainbow&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1"> 2018 </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> UTC   3 km /n Smooth Param: </span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;plots/</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s1">/vort_constraint_reflectivity_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_utc_3km_smooth_param_</span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
    <span class="c1">#############################</span>
    <span class="c1"># Plot 3 km Radial Velocity</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">pydda</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_horiz_xsection_quiver_map</span><span class="p">(</span><span class="n">new_grids</span><span class="p">,</span> <span class="n">background_field</span><span class="o">=</span><span class="s1">&#39;VM&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                                  <span class="n">show_lobes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bg_grid_no</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                                                  <span class="n">colorbar_contour_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">contour_alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                                                  <span class="n">quiverkey_len</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">quiver_spacing_x_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">quiver_spacing_y_km</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                                  <span class="n">quiver_width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;10 November 2018 </span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1"> UTC   3 km /n Smooth Param: </span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;plots/vort_constraint_vel_</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">_utc_3km_smooth_param_</span><span class="si">{</span><span class="n">smooth_param</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
    <span class="n">dual_doppler_analysis</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">smooth_param</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_sounding</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">second_param</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Download ERA Interim data...
2020-08-31 13:28:43 ECMWF API python library 1.5.4
2020-08-31 13:28:43 ECMWF API at https://api.ecmwf.int/v1
2020-08-31 13:28:44 Welcome Maxwell Grover
2020-08-31 13:28:44 In case of problems, please check https://confluence.ecmwf.int/display/WEBAPI/Web+API+FAQ or contact servicedesk@ecmwf.int
2020-08-31 13:28:45 Request submitted
2020-08-31 13:28:45 Request id: 5f4d415d97446011ecb05c6c
2020-08-31 13:28:45 Request is submitted
2020-08-31 13:28:46 Request is active
Calling &#39;nice mars /tmp/20200831-1820/2d/tmp-_marscZUlTA.req&#39;
mars - WARN -
mars - WARN - From 29 January 2019 10AM (UTC) MARS uses the interpolation
mars - WARN - provided by the MIR library. For more details, see
mars - WARN - https://confluence.ecmwf.int/display/UDOC/MARS+interpolation+with+MIR
mars - WARN -
MIR environment variables:
MIR_CACHE_PATH=/data/ec_coeff
mars - INFO   - 20200831.182846 - Welcome to MARS
mars - INFO   - 20200831.182846 - MARS Client bundle version: 6.28.6.1
mars - INFO   - 20200831.182846 - MARS Client package version: 6.28.6
mars - INFO   - 20200831.182846 - MARS Client build stamp: 20200717102127
mars - INFO   - 20200831.182846 - MIR version: 1.4.7
mars - INFO   - 20200831.182846 - Using ecCodes version 2.18.0
mars - INFO   - 20200831.182846 - Using odb_api version: 0.15.11 (file format version: 0.5)
mars - INFO   - 20200831.182846 - Using FDB5 version: 5.6.1
mars - INFO   - 20200831.182846 - Maximum retrieval size is 50.00 G
retrieve,stream=oper,levelist=1/2/3/5/7/10/20/30/50/70/100/125/150/175/200/225/250/300/350/400/450/500/550/600/650/700/750/775/800/825/850/875/900/925/950/975/1000,area=-31.8/-64.5/-32.4/-63.9,levtype=pl,param=131.128/132.128/135.128/129.128,padding=0,step=0,grid=0.75/0.75,expver=0001,time=18,date=2018-11-10,class=eimars - WARN   - 20200831.182846 - For full resolution grid, it is recommended to use RESOL=AV to prevent any truncation before transformation
mars - INFO   - 20200831.182846 - Automatic split by date is on

mars - INFO   - 20200831.182846 - Processing request 1

RETRIEVE,
    CLASS      = EI,
    TYPE       = AN,
    STREAM     = OPER,
    EXPVER     = 0001,
    REPRES     = SH,
    LEVTYPE    = PL,
    LEVELIST   = 1/2/3/5/7/10/20/30/50/70/100/125/150/175/200/225/250/300/350/400/450/500/550/600/650/700/750/775/800/825/850/875/900/925/950/975/1000,
    PARAM      = 131.128/132.128/135.128/129.128,
    TIME       = 1800,
    STEP       = 0,
    DOMAIN     = G,
    RESOL      = AUTO,
    AREA       = -31.8/-64.5/-32.4/-63.9,
    GRID       = 0.75/0.75,
    PADDING    = 0,
    DATE       = 20181110

mars - INFO   - 20200831.182846 - Web API request id: 5f4d415d97446011ecb05c6c
mars - INFO   - 20200831.182846 - Requesting 148 fields
mars - INFO   - 20200831.182846 - Calling mars on &#39;marser&#39;, local port is 60990
mars - INFO   - 20200831.182846 - Server task is 365 [marser]
mars - INFO   - 20200831.182846 - Request cost: 148 fields, 18.7188 Mbytes online, nodes: mvr06 [marser]
mars - INFO   - 20200831.182846 - Wind conversion requested by server
mars - INFO   - 20200831.182846 - Transfering 19628056 bytes
mars - INFO   - 20200831.182847 - ShToGridded: loading Legendre coefficients &#39;/data/ec_coeff/mir/legendre/4/local-T239-GaussianN120-OPT4189816c2e.leg&#39;
mars - INFO   - 20200831.182847 - Deriving U and V from vorticity and divergence
mars - INFO   - 20200831.182849 - 148 fields retrieved from &#39;marser&#39;
mars - INFO   - 20200831.182849 - 148 fields have been interpolated
mars - INFO   - 20200831.182849 - Request time:  wall: 3 sec  cpu: 2 sec
mars - INFO   - 20200831.182849 -   Read from network: 18.72 Mbyte(s) in &lt; 1 sec [37.06 Mbyte/sec]
mars - INFO   - 20200831.182849 -   Visiting marser: wall: 3 sec
mars - INFO   - 20200831.182849 -   Post-processing: wall: 2 sec cpu: 2 sec
mars - INFO   - 20200831.182849 -   Writing to target file: 15.90 Kbyte(s) in &lt; 1 sec [1014.00 Kbyte/sec]
mars - INFO   - 20200831.182849 - Memory used: 44.61 Mbyte(s)
mars - INFO   - 20200831.182849 - No errors reported
Process &#39;[&#39;nice&#39;, &#39;mars&#39;, &#39;/tmp/20200831-1820/2d/tmp-_marscZUlTA.req&#39;]&#39; finished
Calling &#39;nice grib_to_netcdf /data/scratch/20200831-1820/9f/_mars-webmars-public-svc-blue-001-6fe5cac1a363ec1525f54343b6cc9fd8-Klc4hj.grib -o /data/scratch/20200831-1820/43/_grib2netcdf-webmars-public-svc-blue-000-6fe5cac1a363ec1525f54343b6cc9fd8-nXp11D.nc -utime&#39;
grib_to_netcdf: Version 2.18.0
grib_to_netcdf: Processing input file &#39;/data/scratch/20200831-1820/9f/_mars-webmars-public-svc-blue-001-6fe5cac1a363ec1525f54343b6cc9fd8-Klc4hj.grib&#39;.
grib_to_netcdf: Found 148 GRIB fields in 1 file.
grib_to_netcdf: Ignoring key(s): method, type, stream, refdate, hdate
grib_to_netcdf: Creating netCDF file &#39;/data/scratch/20200831-1820/43/_grib2netcdf-webmars-public-svc-blue-000-6fe5cac1a363ec1525f54343b6cc9fd8-nXp11D.nc&#39;
grib_to_netcdf: NetCDF library version: 4.3.3.1 of Dec 10 2015 16:44:18 $
grib_to_netcdf: Creating large (64 bit) file format.
grib_to_netcdf: Defining variable &#39;w&#39;.
grib_to_netcdf: Defining variable &#39;z&#39;.
grib_to_netcdf: Defining variable &#39;u&#39;.
grib_to_netcdf: Defining variable &#39;v&#39;.
grib_to_netcdf: Done.
Process &#39;[&#39;nice&#39;, &#39;grib_to_netcdf&#39;, &#39;/data/scratch/20200831-1820/9f/_mars-webmars-public-svc-blue-001-6fe5cac1a363ec1525f54343b6cc9fd8-Klc4hj.grib&#39;, &#39;-o&#39;, &#39;/data/scratch/20200831-1820/43/_grib2netcdf-webmars-public-svc-blue-000-6fe5cac1a363ec1525f54343b6cc9fd8-nXp11D.nc&#39;, &#39;-utime&#39;]&#39; finished
2020-08-31 13:28:52 Request is complete
2020-08-31 13:28:52 Transfering 2.53125 Kbytes into /var/folders/dd/zgpcpccj46q2tfrvpwpp3r5w0000gn/T/tmp8n43cbma
2020-08-31 13:28:52 From https://stream.ecmwf.int/data/webmars-public-svc-blue-000/data/scratch/20200831-1820/43/_grib2netcdf-webmars-public-svc-blue-000-6fe5cac1a363ec1525f54343b6cc9fd8-nXp11D.nc
2020-08-31 13:28:52 Transfer rate 4.87089 Kbytes/s
Calculating weights for radars 0 and 1
Calculating weights for models...
Starting solver 
rmsVR = 21.272561224299345
Total points: 165400
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:408: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:409: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:419: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:420: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 146.6696| 637.9176|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  85.1680
Norm of gradient: 0.07935328058422833
Iterations before filter: 10
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|  87.2911| 529.1742|   0.0000|   0.0000|   0.0001|   0.0000|   0.0000|  93.7495
Norm of gradient: 0.08120502082651836
Iterations before filter: 20
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|  53.6721| 513.9433|   0.0000|   0.0000|   0.0001|   0.0000|   0.0000|  97.2404
Norm of gradient: 0.04814619965261029
Iterations before filter: 30
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|  53.2962| 514.1742|   0.0000|   0.0000|   0.0001|   0.0000|   0.0000|  97.2578
Norm of gradient: 0.04830782412857658
Iterations before filter: 40
Applying low pass filter to wind field...
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|8293.2121| 446.0019|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  46.3354
Norm of gradient: 0.1715791648029771
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|8219.3997| 445.2171|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  46.3573
Norm of gradient: 0.17022850139143314
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 393.2368| 813.4342|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  52.1118
Norm of gradient: 0.05726674095032224
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 216.0191| 747.0091|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  52.5758
Norm of gradient: 0.06698429741755814
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 173.3670| 585.9617|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  51.9593
Norm of gradient: 0.044854444375534354
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 137.8444| 484.6339|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  56.7010
Norm of gradient: 0.03288516373681457
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 112.1064| 468.6932|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  62.1934
Norm of gradient: 0.03559839686258209
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 124.2240| 536.3347|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  76.2040
Norm of gradient: 0.07601957900013732
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|  99.4757| 460.0264|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  65.6137
Norm of gradient: 0.03823731589869442
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 114.1317| 561.6280|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  84.0764
Norm of gradient: 0.06729642310466184
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|  86.7073| 455.7837|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  69.5424
Norm of gradient: 0.03980122641343633
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 161.8409| 624.3505|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  96.9268
Norm of gradient: 0.07138129235922891
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|  77.6954| 449.9467|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  74.9320
Norm of gradient: 0.04077582781855498
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 144.4209| 605.2767|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000| 100.0000
Norm of gradient: 0.05377274253622062
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|  72.5019| 449.8673|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  79.4383
Norm of gradient: 0.04078717198483486
Iterations after filter: 1
Iterations after filter: 2
Done! Time = 210.7
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: divide by zero encountered in true_divide
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/cartopy/mpl/geoaxes.py:1478: UserWarning: The following kwargs were not used by contour: &#39;color&#39;
  result = matplotlib.axes.Axes.contour(self, *args, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Download ERA Interim data...
2020-08-31 13:33:58 ECMWF API python library 1.5.4
2020-08-31 13:33:58 ECMWF API at https://api.ecmwf.int/v1
2020-08-31 13:33:58 Welcome Maxwell Grover
2020-08-31 13:33:59 In case of problems, please check https://confluence.ecmwf.int/display/WEBAPI/Web+API+FAQ or contact servicedesk@ecmwf.int
2020-08-31 13:33:59 Request submitted
2020-08-31 13:33:59 Request id: 5f4d4297cb8af4f322b05c74
2020-08-31 13:33:59 Request is submitted
2020-08-31 13:34:01 Request is active
Calling &#39;nice mars /tmp/20200831-1830/ef/tmp-_marsiWVvn_.req&#39;
mars - WARN -
mars - WARN - From 29 January 2019 10AM (UTC) MARS uses the interpolation
mars - WARN - provided by the MIR library. For more details, see
mars - WARN - https://confluence.ecmwf.int/display/UDOC/MARS+interpolation+with+MIR
mars - WARN -
MIR environment variables:
MIR_CACHE_PATH=/data/ec_coeff
mars - INFO   - 20200831.183400 - Welcome to MARS
mars - INFO   - 20200831.183400 - MARS Client bundle version: 6.28.6.1
mars - INFO   - 20200831.183400 - MARS Client package version: 6.28.6
mars - INFO   - 20200831.183400 - MARS Client build stamp: 20200717102127
mars - INFO   - 20200831.183400 - MIR version: 1.4.7
mars - INFO   - 20200831.183400 - Using ecCodes version 2.18.0
mars - INFO   - 20200831.183400 - Using odb_api version: 0.15.11 (file format version: 0.5)
mars - INFO   - 20200831.183400 - Using FDB5 version: 5.6.1
mars - INFO   - 20200831.183400 - Maximum retrieval size is 50.00 G
retrieve,stream=oper,levelist=1/2/3/5/7/10/20/30/50/70/100/125/150/175/200/225/250/300/350/400/450/500/550/600/650/700/750/775/800/825/850/875/900/925/950/975/1000,area=-31.8/-64.5/-32.4/-63.9,levtype=pl,param=131.128/132.128/135.128/129.128,padding=0,step=0,grid=0.75/0.75,expver=0001,time=18,date=2018-11-10,class=eimars - WARN   - 20200831.183400 - For full resolution grid, it is recommended to use RESOL=AV to prevent any truncation before transformation
mars - INFO   - 20200831.183400 - Automatic split by date is on

mars - INFO   - 20200831.183400 - Processing request 1

RETRIEVE,
    CLASS      = EI,
    TYPE       = AN,
    STREAM     = OPER,
    EXPVER     = 0001,
    REPRES     = SH,
    LEVTYPE    = PL,
    LEVELIST   = 1/2/3/5/7/10/20/30/50/70/100/125/150/175/200/225/250/300/350/400/450/500/550/600/650/700/750/775/800/825/850/875/900/925/950/975/1000,
    PARAM      = 131.128/132.128/135.128/129.128,
    TIME       = 1800,
    STEP       = 0,
    DOMAIN     = G,
    RESOL      = AUTO,
    AREA       = -31.8/-64.5/-32.4/-63.9,
    GRID       = 0.75/0.75,
    PADDING    = 0,
    DATE       = 20181110

mars - INFO   - 20200831.183400 - Web API request id: 5f4d4297cb8af4f322b05c74
mars - INFO   - 20200831.183400 - Requesting 148 fields
mars - INFO   - 20200831.183400 - Calling mars on &#39;marser&#39;, local port is 39257
mars - INFO   - 20200831.183400 - Server task is 965 [marser]
mars - INFO   - 20200831.183400 - Request cost: 148 fields, 18.7188 Mbytes online, nodes: mvr06 [marser]
mars - INFO   - 20200831.183400 - Wind conversion requested by server
mars - INFO   - 20200831.183400 - Transfering 19628056 bytes
mars - INFO   - 20200831.183400 - ShToGridded: loading Legendre coefficients &#39;/data/ec_coeff/mir/legendre/4/local-T239-GaussianN120-OPT4189816c2e.leg&#39;
mars - INFO   - 20200831.183401 - Deriving U and V from vorticity and divergence
mars - INFO   - 20200831.183403 - 148 fields retrieved from &#39;marser&#39;
mars - INFO   - 20200831.183403 - 148 fields have been interpolated
mars - INFO   - 20200831.183403 - Request time:  wall: 3 sec  cpu: 2 sec
mars - INFO   - 20200831.183403 -   Read from network: 18.72 Mbyte(s) in &lt; 1 sec [141.33 Mbyte/sec]
mars - INFO   - 20200831.183403 -   Visiting marser: wall: 3 sec
mars - INFO   - 20200831.183403 -   Post-processing: wall: 2 sec cpu: 2 sec
mars - INFO   - 20200831.183403 -   Writing to target file: 15.90 Kbyte(s) in &lt; 1 sec [406.09 Kbyte/sec]
mars - INFO   - 20200831.183403 - Memory used: 44.61 Mbyte(s)
mars - INFO   - 20200831.183403 - No errors reported
Process &#39;[&#39;nice&#39;, &#39;mars&#39;, &#39;/tmp/20200831-1830/ef/tmp-_marsiWVvn_.req&#39;]&#39; finished
Calling &#39;nice grib_to_netcdf /data/scratch/20200831-1830/07/_mars-webmars-public-svc-blue-004-6fe5cac1a363ec1525f54343b6cc9fd8-wh5f2A.grib -o /data/scratch/20200831-1830/d3/_grib2netcdf-webmars-public-svc-blue-006-6fe5cac1a363ec1525f54343b6cc9fd8-s8QgVj.nc -utime&#39;
grib_to_netcdf: Version 2.18.0
grib_to_netcdf: Processing input file &#39;/data/scratch/20200831-1830/07/_mars-webmars-public-svc-blue-004-6fe5cac1a363ec1525f54343b6cc9fd8-wh5f2A.grib&#39;.
grib_to_netcdf: Found 148 GRIB fields in 1 file.
grib_to_netcdf: Ignoring key(s): method, type, stream, refdate, hdate
grib_to_netcdf: Creating netCDF file &#39;/data/scratch/20200831-1830/d3/_grib2netcdf-webmars-public-svc-blue-006-6fe5cac1a363ec1525f54343b6cc9fd8-s8QgVj.nc&#39;
grib_to_netcdf: NetCDF library version: 4.3.3.1 of Dec 10 2015 16:44:18 $
grib_to_netcdf: Creating large (64 bit) file format.
grib_to_netcdf: Defining variable &#39;w&#39;.
grib_to_netcdf: Defining variable &#39;z&#39;.
grib_to_netcdf: Defining variable &#39;u&#39;.
grib_to_netcdf: Defining variable &#39;v&#39;.
grib_to_netcdf: Done.
Process &#39;[&#39;nice&#39;, &#39;grib_to_netcdf&#39;, &#39;/data/scratch/20200831-1830/07/_mars-webmars-public-svc-blue-004-6fe5cac1a363ec1525f54343b6cc9fd8-wh5f2A.grib&#39;, &#39;-o&#39;, &#39;/data/scratch/20200831-1830/d3/_grib2netcdf-webmars-public-svc-blue-006-6fe5cac1a363ec1525f54343b6cc9fd8-s8QgVj.nc&#39;, &#39;-utime&#39;]&#39; finished
2020-08-31 13:34:07 Request is complete
2020-08-31 13:34:07 Transfering 2.53125 Kbytes into /var/folders/dd/zgpcpccj46q2tfrvpwpp3r5w0000gn/T/tmpq9ge7b7p
2020-08-31 13:34:07 From https://stream.ecmwf.int/data/webmars-public-svc-blue-006/data/scratch/20200831-1830/d3/_grib2netcdf-webmars-public-svc-blue-006-6fe5cac1a363ec1525f54343b6cc9fd8-s8QgVj.nc
2020-08-31 13:34:07 Transfer rate 4.92714 Kbytes/s
Calculating weights for radars 0 and 1
Calculating weights for models...
Starting solver 
rmsVR = 20.837894214037224
Total points: 160055
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:652: RuntimeWarning: invalid value encountered in true_divide
  theta_1 = np.arccos(x/a)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:653: RuntimeWarning: invalid value encountered in arccos
  theta_2 = np.arccos((x-rad2[1])/b)
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:654: RuntimeWarning: invalid value encountered in true_divide
  return np.arccos((a*a+b*b-c*c)/(2*a*b))
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:408: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:409: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:419: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &gt;= math.radians(min_bca),
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:420: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca)))] += 1
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in greater_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
/Users/mgrover/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py:429: RuntimeWarning: invalid value encountered in less_equal
  bca[i, j] &lt;= math.radians(max_bca))] = 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
| 142.5886| 694.1900|   0.0000|   0.0000|   0.0000|   0.0000|   0.0000|  80.6109
Norm of gradient: 0.3180886525353942
Iterations before filter: 10
| Jvel    | Jmass   | Jsmooth |   Jbg   | Jvort   | Jmodel  | Jpoint  | Max w  
|  91.8737| 578.0423|   0.0000|   0.0000|   0.0001|   0.0000|   0.0000|  92.4386
Norm of gradient: 0.2913748260632707
Iterations before filter: 20
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">35</span><span class="o">-</span><span class="n">bf3a023e5c83</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">times</span><span class="p">:</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="n">dual_doppler_analysis</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">smooth_param</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">use_sounding</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">second_param</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nn">&lt;ipython-input-34-8566b7670636&gt;</span> in <span class="ni">dual_doppler_analysis</span><span class="nt">(time, smooth_param, use_sounding, second_param, case, radar1, radar2)</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>                                                   <span class="n">Co</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">Cm</span><span class="o">=</span><span class="mf">1000.</span><span class="p">,</span> <span class="n">Cx</span><span class="o">=</span><span class="n">second_param</span><span class="p">,</span> <span class="n">Cy</span><span class="o">=</span><span class="n">second_param</span><span class="p">,</span> <span class="n">upper_bc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>                                                   <span class="n">Cv</span><span class="o">=</span><span class="mf">.001</span><span class="p">,</span> <span class="n">Ut</span> <span class="o">=</span> <span class="mf">7.4</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">13.34</span><span class="p">,</span>
<span class="ne">---&gt; </span><span class="mi">43</span>                                                   <span class="n">mask_outside_opt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span> 
<span class="g g-Whitespace">     </span><span class="mi">45</span>     <span class="c1"># Write the first grid to netcdf containing the dual doppler analysis</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/retrieval/wind_retrieve.py</span> in <span class="ni">get_dd_wind_field</span><span class="nt">(Grids, u_init, v_init, w_init, points, vel_name, refl_field, u_back, v_back, z_back, frz, Co, Cm, Cx, Cy, Cz, Cb, Cv, Cmod, Cpoint, Ut, Vt, filt_iterations, mask_outside_opt, weights_obs, weights_model, weights_bg, max_iterations, mask_w_outside_opt, filter_window, filter_order, min_bca, max_bca, upper_bc, model_fields, output_cost_functions, roi)</span>
<span class="g g-Whitespace">    </span><span class="mi">516</span>         <span class="n">winds</span> <span class="o">=</span> <span class="n">fmin_l_bfgs_b</span><span class="p">(</span><span class="n">J_function</span><span class="p">,</span> <span class="n">winds</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">parameters</span><span class="p">,),</span>
<span class="g g-Whitespace">    </span><span class="mi">517</span>                               <span class="n">maxiter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pgtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">518</span>                               <span class="n">fprime</span><span class="o">=</span><span class="n">grad_J</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">iprint</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">519</span>         <span class="n">parameters</span><span class="o">.</span><span class="n">print_out</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">520</span>         <span class="k">if</span> <span class="n">output_cost_functions</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/lbfgsb.py</span> in <span class="ni">fmin_l_bfgs_b</span><span class="nt">(func, x0, fprime, args, approx_grad, bounds, m, factr, pgtol, epsilon, iprint, maxfun, maxiter, disp, callback, maxls)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span> 
<span class="g g-Whitespace">    </span><span class="mi">197</span>     <span class="n">res</span> <span class="o">=</span> <span class="n">_minimize_lbfgsb</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">jac</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">198</span>                            <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">199</span>     <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;grad&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;jac&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span>          <span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">],</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/lbfgsb.py</span> in <span class="ni">_minimize_lbfgsb</span><span class="nt">(fun, x0, args, jac, bounds, disp, maxcor, ftol, gtol, eps, maxfun, maxiter, iprint, callback, maxls, finite_diff_rel_step, **unknown_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span>             <span class="c1"># until the completion of the current minimization iteration.</span>
<span class="g g-Whitespace">    </span><span class="mi">359</span>             <span class="c1"># Overwrite f and g:</span>
<span class="ne">--&gt; </span><span class="mi">360</span>             <span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">func_and_grad</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">361</span>         <span class="k">elif</span> <span class="n">task_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;NEW_X&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span>             <span class="c1"># new iteration</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py</span> in <span class="ni">fun_and_grad</span><span class="nt">(self, x)</span>
<span class="g g-Whitespace">    </span><span class="mi">199</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_update_x_impl</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_update_fun</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">201</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_update_grad</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">202</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span> 

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py</span> in <span class="ni">_update_grad</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">169</span>     <span class="k">def</span> <span class="nf">_update_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">170</span>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_updated</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">171</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_update_grad_impl</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span>             <span class="bp">self</span><span class="o">.</span><span class="n">g_updated</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span> 

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py</span> in <span class="ni">update_grad</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span> 
<span class="g g-Whitespace">     </span><span class="mi">84</span>             <span class="k">def</span> <span class="nf">update_grad</span><span class="p">():</span>
<span class="ne">---&gt; </span><span class="mi">85</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">grad_wrapped</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">86</span> 
<span class="g g-Whitespace">     </span><span class="mi">87</span>         <span class="k">elif</span> <span class="n">grad</span> <span class="ow">in</span> <span class="n">FD_METHODS</span><span class="p">:</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py</span> in <span class="ni">grad_wrapped</span><span class="nt">(x)</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span>             <span class="k">def</span> <span class="nf">grad_wrapped</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">ngev</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">---&gt; </span><span class="mi">82</span>                 <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span> 
<span class="g g-Whitespace">     </span><span class="mi">84</span>             <span class="k">def</span> <span class="nf">update_grad</span><span class="p">():</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/cost_functions/cost_functions.py</span> in <span class="ni">grad_J</span><span class="nt">(winds, parameters)</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span>             <span class="n">winds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">winds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">winds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">parameters</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span>             <span class="n">parameters</span><span class="o">.</span><span class="n">dx</span><span class="p">,</span> <span class="n">parameters</span><span class="o">.</span><span class="n">dy</span><span class="p">,</span> <span class="n">parameters</span><span class="o">.</span><span class="n">dz</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">131</span>             <span class="n">coeff</span><span class="o">=</span><span class="n">parameters</span><span class="o">.</span><span class="n">Cm</span><span class="p">,</span> <span class="n">upper_bc</span><span class="o">=</span><span class="n">parameters</span><span class="o">.</span><span class="n">upper_bc</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span> 
<span class="g g-Whitespace">    </span><span class="mi">133</span>     <span class="k">if</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">Cx</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">parameters</span><span class="o">.</span><span class="n">Cy</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">parameters</span><span class="o">.</span><span class="n">Cz</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/pydda/cost_functions/cost_functions.py</span> in <span class="ni">calculate_mass_continuity_gradient</span><span class="nt">(u, v, w, z, dx, dy, dz, coeff, anel, upper_bc)</span>
<span class="g g-Whitespace">    </span><span class="mi">611</span>     <span class="n">grad_u</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">div2</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">coeff</span>
<span class="g g-Whitespace">    </span><span class="mi">612</span>     <span class="n">grad_v</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">div2</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">coeff</span>
<span class="ne">--&gt; </span><span class="mi">613</span>     <span class="n">grad_w</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">div2</span><span class="p">,</span> <span class="n">dz</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">coeff</span>
<span class="g g-Whitespace">    </span><span class="mi">614</span> 
<span class="g g-Whitespace">    </span><span class="mi">615</span>     <span class="c1"># Impermeability condition</span>

<span class="nn">&lt;__array_function__ internals&gt;</span> in <span class="ni">gradient</span><span class="nt">(*args, **kwargs)</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/numpy/lib/function_base.py</span> in <span class="ni">gradient</span><span class="nt">(f, *varargs, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1055</span> 
<span class="g g-Whitespace">   </span><span class="mi">1056</span>         <span class="k">if</span> <span class="n">uniform_spacing</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1057</span>             <span class="n">out</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">slice1</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">slice4</span><span class="p">)]</span> <span class="o">-</span> <span class="n">f</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">slice2</span><span class="p">)])</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">ax_dx</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1058</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1059</span>             <span class="n">dx1</span> <span class="o">=</span> <span class="n">ax_dx</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error in callback &lt;function flush_figures at 0x7f83dd9d9dd0&gt; (for post_execute):
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/ipykernel/pylab/backend_inline.py</span> in <span class="ni">flush_figures</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span>         <span class="c1"># ignore the tracking, just draw and close all figures</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">121</span>             <span class="k">return</span> <span class="n">show</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">122</span>         <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">123</span>             <span class="c1"># safely show traceback if in IPython, else raise</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/ipykernel/pylab/backend_inline.py</span> in <span class="ni">show</span><span class="nt">(close, block)</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>             <span class="n">display</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span>                 <span class="n">figure_manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">,</span>
<span class="ne">---&gt; </span><span class="mi">43</span>                 <span class="n">metadata</span><span class="o">=</span><span class="n">_fetch_figure_metadata</span><span class="p">(</span><span class="n">figure_manager</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">44</span>             <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">45</span>     <span class="k">finally</span><span class="p">:</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/display.py</span> in <span class="ni">display</span><span class="nt">(include, exclude, metadata, transient, display_id, *objs, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span>             <span class="n">publish_display_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">obj</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">313</span>             <span class="n">format_dict</span><span class="p">,</span> <span class="n">md_dict</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">include</span><span class="o">=</span><span class="n">include</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="n">exclude</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">format_dict</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">315</span>                 <span class="c1"># nothing to display (e.g. _ipython_display_ took over)</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/formatters.py</span> in <span class="ni">format</span><span class="nt">(self, obj, include, exclude)</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span>             <span class="n">md</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">180</span>                 <span class="n">data</span> <span class="o">=</span> <span class="n">formatter</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">181</span>             <span class="k">except</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span>                 <span class="c1"># FIXME: log the exception</span>

<span class="nn">&lt;decorator-gen-9&gt;</span> in <span class="ni">__call__</span><span class="nt">(self, obj)</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/formatters.py</span> in <span class="ni">catch_format_error</span><span class="nt">(method, self, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>     <span class="sd">&quot;&quot;&quot;show traceback on failed format call&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">224</span>         <span class="n">r</span> <span class="o">=</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>     <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>         <span class="c1"># don&#39;t warn on NotImplementedErrors</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/formatters.py</span> in <span class="ni">__call__</span><span class="nt">(self, obj)</span>
<span class="g g-Whitespace">    </span><span class="mi">339</span>                 <span class="k">pass</span>
<span class="g g-Whitespace">    </span><span class="mi">340</span>             <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">341</span>                 <span class="k">return</span> <span class="n">printer</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span>             <span class="c1"># Finally look for special method names</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span>             <span class="n">method</span> <span class="o">=</span> <span class="n">get_real_method</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_method</span><span class="p">)</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/pylabtools.py</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(fig)</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span> 
<span class="g g-Whitespace">    </span><span class="mi">247</span>     <span class="k">if</span> <span class="s1">&#39;png&#39;</span> <span class="ow">in</span> <span class="n">formats</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">248</span>         <span class="n">png_formatter</span><span class="o">.</span><span class="n">for_type</span><span class="p">(</span><span class="n">Figure</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">fig</span><span class="p">:</span> <span class="n">print_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>     <span class="k">if</span> <span class="s1">&#39;retina&#39;</span> <span class="ow">in</span> <span class="n">formats</span> <span class="ow">or</span> <span class="s1">&#39;png2x&#39;</span> <span class="ow">in</span> <span class="n">formats</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">250</span>         <span class="n">png_formatter</span><span class="o">.</span><span class="n">for_type</span><span class="p">(</span><span class="n">Figure</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">fig</span><span class="p">:</span> <span class="n">retina_figure</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/IPython/core/pylabtools.py</span> in <span class="ni">print_figure</span><span class="nt">(fig, fmt, bbox_inches, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">130</span>         <span class="n">FigureCanvasBase</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span> 
<span class="ne">--&gt; </span><span class="mi">132</span>     <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">print_figure</span><span class="p">(</span><span class="n">bytes_io</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">133</span>     <span class="n">data</span> <span class="o">=</span> <span class="n">bytes_io</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">134</span>     <span class="k">if</span> <span class="n">fmt</span> <span class="o">==</span> <span class="s1">&#39;svg&#39;</span><span class="p">:</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/backend_bases.py</span> in <span class="ni">print_figure</span><span class="nt">(self, filename, dpi, facecolor, edgecolor, orientation, format, bbox_inches, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2101</span>                     <span class="n">bbox_artists</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;bbox_extra_artists&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2102</span>                     <span class="n">bbox_inches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">2103</span>                             <span class="n">bbox_extra_artists</span><span class="o">=</span><span class="n">bbox_artists</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2104</span>                     <span class="n">pad</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pad_inches&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2105</span>                     <span class="k">if</span> <span class="n">pad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/figure.py</span> in <span class="ni">get_tightbbox</span><span class="nt">(self, renderer, bbox_extra_artists)</span>
<span class="g g-Whitespace">   </span><span class="mi">2393</span>                 <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2394</span>                     <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">2395</span>                             <span class="n">bbox_extra_artists</span><span class="o">=</span><span class="n">bbox_extra_artists</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2396</span>                 <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2397</span>                     <span class="n">bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/axes/_base.py</span> in <span class="ni">get_tightbbox</span><span class="nt">(self, renderer, call_axes_locator, bbox_extra_artists)</span>
<span class="g g-Whitespace">   </span><span class="mi">4325</span>                 <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bb_xaxis</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4326</span> 
<span class="ne">-&gt; </span><span class="mi">4327</span>             <span class="n">bb_yaxis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_tightbbox</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4328</span>             <span class="k">if</span> <span class="n">bb_yaxis</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4329</span>                 <span class="n">bb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bb_yaxis</span><span class="p">)</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/axis.py</span> in <span class="ni">get_tightbbox</span><span class="nt">(self, renderer)</span>
<span class="g g-Whitespace">   </span><span class="mi">1184</span>             <span class="k">return</span>
<span class="g g-Whitespace">   </span><span class="mi">1185</span> 
<span class="ne">-&gt; </span><span class="mi">1186</span>         <span class="n">ticks_to_draw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_ticks</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1187</span> 
<span class="g g-Whitespace">   </span><span class="mi">1188</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_update_label_position</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/axis.py</span> in <span class="ni">_update_ticks</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1101</span>         <span class="n">the</span> <span class="n">axes</span><span class="o">.</span>  <span class="n">Return</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">ticks</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">drawn</span><span class="o">.</span>
<span class="g g-Whitespace">   </span><span class="mi">1102</span>         <span class="sd">&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1103</span><span class="sd">         major_locs = self.get_majorticklocs()</span>
<span class="g g-Whitespace">   </span><span class="mi">1104</span><span class="sd">         major_labels = self.major.formatter.format_ticks(major_locs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1105</span><span class="sd">         major_ticks = self.get_major_ticks(len(major_locs))</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/axis.py</span> in <span class="ni">get_majorticklocs</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1346</span><span class="sd">     def get_majorticklocs(self):</span>
<span class="g g-Whitespace">   </span><span class="mi">1347</span><span class="sd">         &quot;&quot;&quot;</span><span class="n">Get</span> <span class="n">the</span> <span class="n">array</span> <span class="n">of</span> <span class="n">major</span> <span class="n">tick</span> <span class="n">locations</span> <span class="ow">in</span> <span class="n">data</span> <span class="n">coordinates</span><span class="o">.</span><span class="s2">&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1348</span><span class="s2">         return self.major.locator()</span>
<span class="g g-Whitespace">   </span><span class="mi">1349</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1350</span><span class="s2">     def get_minorticklocs(self):</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/ticker.py</span> in <span class="ni">__call__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">2201</span><span class="s2">     def __call__(self):</span>
<span class="g g-Whitespace">   </span><span class="mi">2202</span><span class="s2">         vmin, vmax = self.axis.get_view_interval()</span>
<span class="ne">-&gt; </span><span class="mi">2203</span><span class="s2">         return self.tick_values(vmin, vmax)</span>
<span class="g g-Whitespace">   </span><span class="mi">2204</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">2205</span><span class="s2">     def tick_values(self, vmin, vmax):</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/colorbar.py</span> in <span class="ni">tick_values</span><span class="nt">(self, vmin, vmax)</span>
<span class="g g-Whitespace">    </span><span class="mi">245</span><span class="s2">         vmin = max(vmin, self._colorbar.norm.vmin)</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span><span class="s2">         vmax = min(vmax, self._colorbar.norm.vmax)</span>
<span class="ne">--&gt; </span><span class="mi">247</span><span class="s2">         ticks = super().tick_values(vmin, vmax)</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span><span class="s2">         rtol = (vmax - vmin) * 1e-10</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span><span class="s2">         return ticks[(ticks &gt;= vmin - rtol) &amp; (ticks &lt;= vmax + rtol)]</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/ticker.py</span> in <span class="ni">tick_values</span><span class="nt">(self, vmin, vmax)</span>
<span class="g g-Whitespace">   </span><span class="mi">2209</span><span class="s2">         vmin, vmax = mtransforms.nonsingular(</span>
<span class="g g-Whitespace">   </span><span class="mi">2210</span><span class="s2">             vmin, vmax, expander=1e-13, tiny=1e-14)</span>
<span class="ne">-&gt; </span><span class="mi">2211</span><span class="s2">         locs = self._raw_ticks(vmin, vmax)</span>
<span class="g g-Whitespace">   </span><span class="mi">2212</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">2213</span><span class="s2">         prune = self._prune</span>

<span class="nn">~/miniconda3/envs/unidata/lib/python3.7/site-packages/matplotlib/ticker.py</span> in <span class="ni">_raw_ticks</span><span class="nt">(self, vmin, vmax)</span>
<span class="g g-Whitespace">   </span><span class="mi">2194</span><span class="s2">             ticks = np.arange(low, high + 1) * step + best_vmin</span>
<span class="g g-Whitespace">   </span><span class="mi">2195</span><span class="s2">             # Count only the ticks that will be displayed.</span>
<span class="ne">-&gt; </span><span class="mi">2196</span><span class="s2">             nticks = ((ticks &lt;= _vmax) &amp; (ticks &gt;= _vmin)).sum()</span>
<span class="g g-Whitespace">   </span><span class="mi">2197</span><span class="s2">             if nticks &gt;= self._min_n_ticks:</span>
<span class="g g-Whitespace">   </span><span class="mi">2198</span><span class="s2">                 break</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="s1">&#39;2012&#39;</span>
<span class="n">dow6_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/DOW6/v</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">/*&#39;</span><span class="p">)</span>
<span class="n">dow7_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/DOW7/v</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s1">/*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smoothing_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.11</span><span class="p">,</span> <span class="mf">.01</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">smoothing_vals</span><span class="p">:</span>
    <span class="n">dual_doppler_analysis</span><span class="p">(</span><span class="s1">&#39;2014&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">use_sounding</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="november-case">
<h2>12 November Case<a class="headerlink" href="#november-case" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="n">dow6_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;output/Nov12/DOW6/*&#39;</span><span class="p">))</span>
<span class="n">dow7_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;output/Nov12/DOW7/*&#39;</span><span class="p">))</span>
<span class="n">dow8_files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;output/Nov12/DOW8/*&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow6_files</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;output/Nov12/DOW6/cfrad.20181112_020007.258_to_20181112_020420.238_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_020431.790_to_20181112_020844.728_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_021007.906_to_20181112_021420.886_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_021432.438_to_20181112_021845.378_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_022007.270_to_20181112_022420.250_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_022431.802_to_20181112_022844.740_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_023007.920_to_20181112_023420.900_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_023432.450_to_20181112_023845.390_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_024007.296_to_20181112_024420.276_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_024431.826_to_20181112_024844.768_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_025007.946_to_20181112_025420.926_DOW6high_SUR.nc&#39;,
 &#39;output/Nov12/DOW6/cfrad.20181112_025432.478_to_20181112_025845.418_DOW6high_SUR.nc&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dow6_files</span><span class="p">)):</span>
    
    <span class="c1"># Cleanup the radar data</span>
    <span class="n">dow6_radar</span> <span class="o">=</span> <span class="n">cleanup_radar</span><span class="p">(</span><span class="n">dow6_files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">dow7_radar</span> <span class="o">=</span> <span class="n">cleanup_radar</span><span class="p">(</span><span class="n">dow7_files</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="c1">#dow8_radar = cleanup_radar(dow8_files[i])</span>
    
    <span class="c1"># Use DOW7 as the central lat and lon for regridding</span>
    <span class="n">grid_lat</span> <span class="o">=</span> <span class="n">dow6_radar</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">grid_lon</span> <span class="o">=</span> <span class="n">dow6_radar</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1"># Regrid the radars</span>
    <span class="c1">#gridded_radars = grid_radars([dow6_radar, dow7_radar, dow8_radar], grid_lat=grid_lat, grid_lon=grid_lon, vert_extent=14500,</span>
    <span class="c1">#                              horiz_extent=50000)</span>
    
    <span class="n">gridded_radars</span> <span class="o">=</span> <span class="n">grid_radars</span><span class="p">([</span><span class="n">dow6_radar</span><span class="p">,</span> <span class="n">dow7_radar</span><span class="p">],</span> <span class="n">grid_lat</span><span class="o">=</span><span class="n">grid_lat</span><span class="p">,</span> <span class="n">grid_lon</span><span class="o">=</span><span class="n">grid_lon</span><span class="p">,</span> <span class="n">vert_extent</span><span class="o">=</span><span class="mi">14500</span><span class="p">,</span>
                                  <span class="n">horiz_extent</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
    
    <span class="c1"># Run the dual doppler analysis</span>
    <span class="n">run_dda</span><span class="p">(</span><span class="n">gridded_radars</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s1">&#39;Nov12&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_lat</span> <span class="o">=</span> <span class="n">dow7_radar</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">grid_lon</span> <span class="o">=</span> <span class="n">dow7_radar</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gridded_radars</span> <span class="o">=</span> <span class="n">grid_radars</span><span class="p">([</span><span class="n">dow6_radar</span><span class="p">,</span> <span class="n">dow7_radar</span><span class="p">,</span> <span class="n">dow8_radar</span><span class="p">],</span> <span class="n">grid_lat</span><span class="o">=</span><span class="n">grid_lat</span><span class="p">,</span> <span class="n">grid_lon</span><span class="o">=</span><span class="n">grid_lon</span><span class="p">,</span> <span class="n">vert_extent</span><span class="o">=</span><span class="mi">14500</span><span class="p">,</span>
                              <span class="n">horiz_extent</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">run_dda</span><span class="p">(</span><span class="n">gridded_radars</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s1">&#39;Nov12&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../ot_code/relampago_ots/20181112.02_1min.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="december-case">
<h2>4 December Case<a class="headerlink" href="#december-case" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="n">dow6_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;output/Dec4/DOW6/*&#39;</span><span class="p">)</span>
<span class="n">dow7_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;output/Dec4/DOW7/*&#39;</span><span class="p">)</span>
<span class="n">dow8_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;output/Dec4/DOW8/*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow6_radar</span> <span class="o">=</span> <span class="n">cleanup_radar</span><span class="p">(</span><span class="n">dow6_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow7_radar</span> <span class="o">=</span> <span class="n">cleanup_radar</span><span class="p">(</span><span class="n">dow7_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dow8_radar</span> <span class="o">=</span> <span class="n">cleanup_radar</span><span class="p">(</span><span class="n">dow8_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_lat</span> <span class="o">=</span> <span class="n">dow7_radar</span><span class="o">.</span><span class="n">latitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">grid_lon</span> <span class="o">=</span> <span class="n">dow7_radar</span><span class="o">.</span><span class="n">longitude</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gridded_radars</span> <span class="o">=</span> <span class="n">grid_radars</span><span class="p">([</span><span class="n">dow6_radar</span><span class="p">,</span> <span class="n">dow7_radar</span><span class="p">,</span> <span class="n">dow8_radar</span><span class="p">],</span> <span class="n">grid_lat</span><span class="o">=</span><span class="n">grid_lat</span><span class="p">,</span> <span class="n">grid_lon</span><span class="o">=</span><span class="n">grid_lon</span><span class="p">,</span>
                              <span class="n">horiz_extent</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">run_dda</span><span class="p">(</span><span class="n">gridded_radars</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="s1">&#39;Dec4&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="dual_doppler_preprocess.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Preprocess Dual Doppler Data</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="plot_dual_doppler_output.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Plot Dual Doppler Output</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By The Jupyter Book community<br/>
  
      &copy; Copyright 2020.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>